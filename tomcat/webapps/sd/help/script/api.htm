<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="ru-ru" xml:lang="ru-ru" class="no-feedback" data-mc-search-type="Stem" data-mc-help-system-file-name="HelpScripting.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="">
    <head>
        <style></style>
    </head>
    <body>
        <h1>Методы API</h1>
        <h2><a name="string"></a>api.string Работа со строками</h2>
        <ul>
            <li value="1">
                <p>Соединение непустых строк:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.string.concat(separator, strs)                            </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Соединяет непустые строки strs, используя разделитель separator.
                            </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">separator</td>
                            <td>Разделитель</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">strs</td>
                            <td>Коллекция строк</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">api.string.concat(", ", ["a", "", "c", "d", null]) == "a, c, d"</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Проверка строки на пустоту:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.string.isEmpty(str)
                            </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Проверяет строки на пустоту.
                            </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">str</td>
                            <td>Проверяемая строка</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает "true", если строка пуста или "NULL", иначе "false"</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">api.string.isEmpty("") == true</p>
                                <p class="listing">api.string.isEmpty(null) == true</p>
                                <p class="listing">api.string.isEmpty("hgsdaj") == false</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>&#160;</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.string.isEmptyTrim(str)                            </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Проверяет строки на пустоту.
                            </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">str</td>
                            <td>Проверяемая строка</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает "true", если строка пуста или "NULL", иначе "false"</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">api.string.isEmpty("") == true</p>
                                <p class="listing">api.string.isEmpty(null) == true</p>
                                <p class="listing">api.string.isEmpty("hgsdaj") == false</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Фильтрация коллекции строк:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.string.notEmpty(strs)                                   </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Производит фильтрацию коллекции строк. Результирующая коллекция не&#160;содержит пустых строк                           </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">strs</td>
                            <td>Коллекция строк</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает  непустые строки коллекции.</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">api.string.notEmpty(["a", "", "b", "c"]) == ["a", "b", "c"]</p>
                                <p class="listing">api.string.notEmpty(null) == null</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="4">
                <p>Удаление пробелов в начале и конце строки:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.string.trim(str)                            </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Обрезает пробелы в начале и конце строки                           </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">str</td>
                            <td>Строка</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">api.string.trim(" abc ") == "abc"</p>
                                <p class="listing">api.string.trim([" a ", "b", "c ", " d"]) == ["a", "b", "c", "d"]</p>
                                <p class="listing">api.string.trim(null) == null</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="5">
                <p>Замена части строки:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.string.replace(str, from, to)                           </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Заменяет в строке str подстроку from на to                          </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">str</td>
                            <td>Строка</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">from</td>
                            <td>Заменяемая часть строки</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">to</td>
                            <td>Новая часть строки</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">api.string.replace("Маша ела раму", "ела", "съела") == "Маша съела раму"</p>
                                <p class="listing">api.string.replace(null, "ела", "съела") == null</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="6">
                <p>Проверка наличия подстроки:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.string.contains(str, s)                           </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Проверяет наличие подстроки s  в строке str                          </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">str</td>
                            <td>Строка</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">s</td>
                            <td>Проверяемая подстрока</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">api.string.contains("Маша ела раму", "ела") == true</p>
                                <p class="listing">api.string.contains("Маша ела раму", "съела") == false</p>
                                <p class="listing">api.string.contains(null, "съела") == false</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h3><a name="initialValues_form"></a>Aтрибуты на форме</h3>
        <ul>
            <li value="1">
                <p>Получение значения атрибута с формы:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>                                initialValues.getProperty(attr)                            </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Получение значения атрибута с формы                                  </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attr</td>
                            <td>Код атрибута, значение которого необходимо получить</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает  значение атрибута.</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p>&#160;</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Проверка наличия атрибута на форме:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                initialValues.hasProperty(attr)                            </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Проверяет наличие атрибута на форме.                                  </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attr</td>
                            <td>Код проверяемого атрибута.</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает  true  при наличии атрибута на форме, false при отсутствии атрибута.</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p>&#160;</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p class="comment">Переменая initialValues (значение атрибута) используется в скриптах действия и условия смены статуса.</p>
            </li>
        </ul>
        <h3>Обращение к атрибутам объекта</h3>
        <ul>
            <li value="1">
                <p>obj.код атрибута</p>
                <p class="listing">def titleValue = obj.title</p>
                <p class="listing">def flexValue = obj.flexCode</p>
            </li>
            <li value="2">
                <p> obj['код атрибута']</p>
                <p class="listing"> def other = obj['attrCode']</p>
            </li>
        </ul>
        <h3>Получение значения и параметров атрибута</h3>
        <p class="Subtitle">Получение значения и параметров атрибута типа "Временной интервал":</p>
        <p>Получение значения атрибута типа "Временной интервал":</p>
        <p class="listing">def value = subject.'код атрибута '</p>
        <p>Получение значения системного атрибута текущего запроса "Нормативное время обработки" типа "Временной интервал":</p>
        <p class="listing">def value = subject.resolutionTime</p>
        <p>Получение параметров атрибута типа "Временной интервал":</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation:  '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <thead>
                <tr>
                    <th>Название параметра</th>
                    <th>Получение</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Количество</td>
                    <td>
                                def length = value.length;                           </td>
                </tr>
                <tr>
                    <td>Единица измерения</td>
                    <td>
                                def interval = value.interval;                             </td>
                </tr>
                <tr>
                    <td>Длина интервала в мс.</td>
                    <td>
                                def ms = value.toMiliseconds();                             </td>
                </tr>
            </tbody>
        </table>
        <p class="Subtitle">Получение значения и параметров атрибута типа "Счетчик времени":</p>
        <p>Получение значения атрибута типа "Счетчик времени":</p>
        <p class="listing">subject.'код атрибута типа счетчик времени';</p>
        <p>Получение значения системного атрибута текущего запроса "Время обработки запроса" типа "Счетчик времени":</p>
        <p class="listing"> subject.processingTimeTimer;</p>
        <p>Получение параметров атрибута типа "Счетчик времени":</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <thead>
                <tr>
                    <th>Название параметра</th>
                    <th>Получение</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Статус счетчика времени</td>
                    <td>
                                timerVal.status;                          </td>
                </tr>
                <tr>
                    <td>Код статуса счетчика времени</td>
                    <td>
                                timerVal.status.code;  <![CDATA[                            ]]></td>
                </tr>
                <tr>
                    <td>Время счетчика</td>
                    <td>
                                 timerVal.elapsed;                            </td>
                </tr>
            </tbody>
        </table>
        <p class="Subtitle">Получение значения и параметров атрибута типа "Счетчик времени (обратный)":</p>
        <p>Получение значения атрибута типа "Счетчик времени (обратный)":</p>
        <p class="listing">subject.'код атрибута типа счетчик времени (обратный)';</p>
        <p>Получение значения системного атрибута текущего запроса "Запас нормативного времени обслуживания" типа "Счетчик времени (обратный)":</p>
        <p class="listing">subject.timeAllowanceTimer;</p>
        <p>Получение параметров атрибута типа "Счетчик времени (обратный)":</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <thead>
                <tr>
                    <th>Название параметра</th>
                    <th>Получение</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Статус обратного счетчика времени</td>
                    <td>
                                backTimerVal.status;                          </td>
                </tr>
                <tr>
                    <td>Время окончания счетчика</td>
                    <td>
                                backTimerVal.deadLineTime;                             </td>
                </tr>
                <tr>
                    <td>Остаток времени счетчика</td>
                    <td>
                                 backTimerVal.allowance;                             </td>
                </tr>
                <tr>
                    <td>Код статуса счетчика времени</td>
                    <td>
                                 timerVal.status.code;  <![CDATA[                            ]]></td>
                </tr>
            </tbody>
        </table>
        <p class="Subtitle">Получение значения и параметров атрибутов типа "Гиперссылка":</p>
        <p>Получение значения атрибута типа "Гиперссылка":</p>
        <p class="listing">subject.'код атрибута типа гиперссылка'</p>
        <p>Получение параметров атрибутов типа "Гиперссылка":</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <thead>
                <tr>
                    <th>Название параметра</th>
                    <th>Получение</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Название ссылки</td>
                    <td>
                                hyperlinkVal.text;                         </td>
                </tr>
                <tr>
                    <td>URL ссылки</td>
                    <td>hyperlinkVal.URL;                            </td>
                </tr>
            </tbody>
        </table>
        <h2><a name="types"></a>api.types Создание значений типов данных</h2>
        <ul>
            <li value="1">
                <p>Получение типа/класса:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.types.newClassFqn(fqn)                           </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Получение типа/класса по идентификатору fqn.
                            </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">fqn</td>
                            <td>Строка </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>
                                <p>&#160;</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p> Получение типа запроса по идентификатору 'serviceCall$incident':

</p>
                <p class="listing">def incidentClassFqn = api.types.newClassFqn('serviceCall$incident')</p>
            </li>
            <li value="2">
                <p>Получение нового значения типа "временной интервал":</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.types.newDateTimeInterval(length, interval)                           </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Создание нового значения типа "временной интервал" 
                            </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">length</td>
                            <td>Длительность интервала. Целое число</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">interval</td>
                            <td> Единица измерения интервала SECOND, MINUTE, HOUR, DAY или WEEK. Строка</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">def value = subject.'код атрибута типа временной интервал'</p>
                                <p class="listing">def length = value.length;</p>
                                <p class="listing">def interval = value.interval.toString();</p>
                                <p class="listing">newVal = api.types.newDateTimeInterval(length, interval);</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Получение новой гиперссылки:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.types.newHyperlink([text, url])                          </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Получение новой гиперссылки     
                            </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">text</td>
                            <td>Название гиперссылки</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">url</td>
                            <td> URL гиперссылки</td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h2><a name="utils_obj"></a>api.utils Действия с объектами</h2>
        <p>Для доступа к операциям действий над объектами можно воспользоваться утилитарными методами из api.utils или его коротким псевдонимом utils.</p>
        <h3>Поиск объекта</h3>
        <p class="one1">Поиск объекта осуществляется по коду класса объектов и его атрибутам. </p>
        <ul>
            <li value="1">
                <p>Поиск нескольких объектов.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                utils.find                            </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Поиск нескольких объектов.
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>
                                <p>Возвращает коллекцию объектов (может быть пустой, но не&#160;"null").</p>
                                <p data-mc-conditions="Default.43">Возвращается не сам объект, а только его идентификатор (UUID). При обращении к атрибутам найденного объекта, через его идентификатор производится поиск самого объекта, который берется из текущей сессии. Если в сессии его нет, то объект берется из базы данных.</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p>&#160;</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>Поиск отдела по названию:</p>
                <p class="listing">utils.find('obj', ["title" : "Название объекта"])</p>
                <p>Поиск всех элементов справочника "Уровни срочности":</p>
                <p class="listing">objs = utils.find('urgency', [:])</p>
                <p>Поиск объекта по атрибуту типа "Ссылка на бизнес-объект" по&#160;uuid объекта:</p>
                <p class="listing">objs = utils.find('serviceCall', ["author" : 'employee$12345'])</p>
            </li>
            <li value="2">
                <p>Поиск одного объекта.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                utils.get                           <![CDATA[                            ]]></td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Поиск одного объекта.
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>
                                <p>Возвращает:</p>
                                <ul style="list-style-type: circle;">
                                    <li value="1"> конкретный объект по его уникальному идентификатору;                           <![CDATA[ ]]></li>
                                    <li value="2">"null", если объект не найден;</li>
                                    <li value="3">исключение, если найдено более одного объекта. </li>
                                </ul>
                            </td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p>&#160;</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>Поиск компании:</p>
                <p class="listing">def root = utils.get('root', [:]);</p>
                <p>Поиск элемента справочника "Уровни срочности" с кодом low:</p>
                <p class="listing">def urg = utils.get('urgency', ["code": "low"])</p>
                <p>Поиск объекта по уникальному идентификатору:</p>
                <p class="listing">// в случае отсутствия объекта генерируется исключение</p>
                <p class="listing">utils.get('serviceCall$3201')</p>
            </li>
            <li value="3">
                <p>Получение первого объекта из нескольких найденных.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                utils.findFirst                           <![CDATA[                            ]]></td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Получение первого объекта из нескольких найденных.                           <![CDATA[
                            ]]></td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Первый объект из нескольких найденных.</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p>&#160;</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>Первый найденный элемент справочника "Уровни срочности":</p>
                <p class="listing">obj = utils.findFirst('urgency', [:])</p>
            </li>
        </ul>
        <p>Поиск объекта по атрибуту типа "Ссылка на бизнес-объект":</p>
        <p class="listing">def author = utils.get('employee$12345');</p>
        <p class="listing">objs = utils.find('serviceCall', ["author" : author])</p>
        <p>Поиск объекта по нескольким атрибутам (поиск запроса по автору и услуге):</p>
        <p class="listing">def author = subject.author</p>
        <p class="listing">def service = subject.service</p>
        <p class="listing">objs = utils.find('serviceCall', ["author" : author, "service" : service])</p>
        <h3>Подсчет количества объектов</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                utils.count(fqn,  attributes)                            </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                                Считает количество объектов с определенными значениями атрибутов.                             </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">fqn</td>
                    <td>Класс/тип объектов. Параметр может быть задан в виде строки, содержащей fqn типа/класса, или в виде объекта ClassFqn, или в виде бизнес-объекта.</td>
                </tr>
                <tr>
                    <td class="Metod_attr">attributes</td>
                    <td>Код атрибута и его значение, которое будет учитываться при подсчете объектов.</td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td>Количество объектов указанного типа/класса.</td>
                </tr>
            </tbody>
        </table>
        <p>Количество объектов с метаклассом, совпадающим с метаклассом subject и с указанным названием:</p>
        <p class="listing">utils.count(subject.getMetainfo(), ['title':'some title'])</p>
        <p>ИЛИ</p>
        <p class="listing">utils.count(subject, ['title':'some title'])</p>
        <p>Количество сотрудников с фамилией "Петров":</p>
        <p class="listing">utils.count('employee', ['lastName':'Петров'])</p>
        <h3>Получение коллекции объектов</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                utils.getObjects(Collection&lt;String&gt; uids)                            </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                                Получение коллекции объектов по коллекции UUID.                             </td>
                </tr>
            </tbody>
        </table>
        <h3>Добавление объекта</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                utils.create(objCode,  attributes)                             </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                                Добавление объекта.                            </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr"> objCode</td>
                    <td>Код метакласса создаваемого объекта</td>
                </tr>
                <tr>
                    <td class="Metod_attr">attributes</td>
                    <td>
                        <p>Ассоциативный список кодов изменяемых атрибутов и устанавливаемых значений.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>Создание отдела в компании:</p>
        <p class="listing">def root = utils.get('root', [:]);</p>
        <p class="listing">def ou = utils.create('ou$simple', ["title" : "Название создаваемого отдела", "parent" : root]);</p>
        <p>или</p>
        <p class="listing">def attrs = [:]</p>
        <p class="listing">attrs.title = "Название создаваемого отдела"</p>
        <p class="listing">attrs.parent = root</p>
        <p class="listing">def ou = utils.create('ou$simple', attrs);</p>
        <h3>Удаление объекта</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                utils.delete(obj);                            </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                                Удаление объекта.                            </td>
                </tr>
                <tr>
                    <td>Параметр метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr"> obj</td>
                    <td>Удаляемый объект</td>
                </tr>
            </tbody>
        </table>
        <h3>Создание записи в истории событий объекта</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                utils.event(subject, message);                            </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                                Создание пользовательской записи в истории указанного объекта.                            </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr"> subject</td>
                    <td>Объект, в историю которого добавляется запись</td>
                </tr>
                <tr>
                    <td class="Metod_attr"> message</td>
                    <td>Сообщение в историю</td>
                </tr>
            </tbody>
        </table>
        <p>Добавление записи "Скрипт: Service Desk" в историю событий объекта subject:</p>
        <p class="listing">def message = 'Service Desk';</p>
        <p class="listing">utils.event(subject, message);</p>
        <h3>Сравнения и проверки объектов:</h3>
        <p class="one1">Проверка двух объектов на равенство. Объекты сравниваются по уникальным идентификаторам:</p>
        <p class="listing">utils.equal(obj1, obj2)</p>
        <p class="one1">Проверка двух коллекций на равенство. Коллекции сравниваются поэлементно:</p>
        <p class="listing">utils.equal(objs1, objs2)</p>
        <h2><a name="utils_attr"></a>api.utils Действия с атрибутами объекта</h2>
        <h3>Получение значения атрибута</h3>
        <p class="Subtitle">Получение значения атрибута в заданном представлении:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>В виде строки:</td>
                    <td>utils.asString(def subject, def attrCode);                          </td>
                </tr>
                <tr>
                    <td>В виде описания (plain-text):</td>
                    <td>
                                utils.asText(def subject, def attrCode);                             </td>
                </tr>
                <tr>
                    <td>В виде RTF-текста (html-text):</td>
                    <td>
                                 utils.asRTF(def subject, def attrCode);                            </td>
                </tr>
            </tbody>
        </table>
        <p>Для преобразования простого текста в html формат используется метод utils.formatToHtml(text) см. <a href="#formatToHtml" class="MCXref xref" xrefformat="{para}">Форматирование простого текста  (text) для представления в&#160;html:</a></p>
        <p class="Subtitle">Получение значения агрегирующего атрибута:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                utils.getAggrValueMap(IUUIDIdentifiable obj, String attrCode)                            </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                                Получение значения агрегирующего атрибута.                            </td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td>Возвращает значения агрегирующего атрибута в виде MapMap&lt;String, Object&gt;. Постфикс части агрегирующего атрибута, значение соответствующей части
					 агрегирующего атрибута: _employee, _ou, _team.</td>
                </tr>
            </tbody>
        </table>
        <p class="Subtitle">Получение значения атрибута по таблице соответствий:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                utils.getFromValueMap(attrCode, vmapItem, subject)                            </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                                Получение значения агрегирующего атрибута.                            </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr"> attrCode</td>
                    <td>Код атрибута, значение которого нужно получить.</td>
                </tr>
                <tr>
                    <td class="Metod_attr">vmapItem</td>
                    <td>Элемент справочника "Таблицы соответствий" или его UUID. Если null, то возвращается значение атрибута по умолчанию. При этом атрибут, значение которого
					 нужно получить (attrCode), должен быть выбран в качестве определяемого в этой таблице соответствий;.</td>
                </tr>
                <tr>
                    <td class="Metod_attr">subject</td>
                    <td>Объект, значение атрибута которого необходимо получить.</td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td>Возвращает значение атрибута объекта, определенное по таблице соответствий, или значение по умолчанию, если значение не&#160;удалось определить по таблице 
					соответствий.</td>
                </tr>
            </tbody>
        </table>
        <h3>Получение элемента коллекции</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                               utils.getIterableElement(iterable, position, defaultValue)                         <![CDATA[                           ]]></td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                                Получение элемента коллекции.                            </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">iterable</td>
                    <td>Коллекция элементов</td>
                </tr>
                <tr>
                    <td class="Metod_attr">position</td>
                    <td>Номер позиции в коллекции.</td>
                </tr>
                <tr>
                    <td class="Metod_attr">defaultValue</td>
                    <td>Значение по умолчанию, для случаев, когда нельзя извлечь значение из коллекции (указан неверный номер позиции или несуществующая коллекция)</td>
                </tr>
            </tbody>
        </table>
        <h3>Редактирование атрибутов объекта:</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;">
            </col>
            <col style="width: 70%;">
            </col>
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                utils.edit (obj,  attributes)                             </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                                Редактирование атрибутов объекта.                            </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr"> obj</td>
                    <td>Редактируемый объект</td>
                </tr>
                <tr>
                    <td class="Metod_attr">attributes</td>
                    <td>
                        <p>Ассоциативный список кодов изменяемых атрибутов и устанавливаемых значений.</p>
                        <p>Может использоваться специальное значение: '@comment' для добавления комментария; '@commentAuthor' для указания автора добавляемого комментария.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p class="one1">Изменение названия у компании:</p>
        <p class="listing">def root = utils.get('root', [:]);</p>
        <p class="listing">utils.edit(root, ['title' : "Новое название"]);</p>
        <p>Добавление комментария к объекту, вместо кода атрибута указывается специальное значение '@comment' (комментарий):</p>
        <p class="listing">def serviceCall = utils.get('serviceCall$3801');</p>
        <p class="listing">utils.edit(serviceCall, ['@comment' : 'Текст комментария']);</p>
        <p>Добавление комментария с указанием автора, используется '@commentAuthor' (автор добавляемого комментария):</p>
        <p class="listing">def serviceCall = utils.get('serviceCall$3801');</p>
        <p class="listing">utils.edit(serviceCall, ['@comment' : 'Текст комментария', '@commentAuthor' : user]);</p>
        <p>Установка значения агрегирующего атрибута при редактировании или добавлении объекта:</p>
        <p class="listing">//Редактируем значение агрегирующего атрибута с кодом 'aggr', устанавливая сотрудника в рамках отдела</p>
        <p class="listing">utils.edit(subject, ['aggr' : ['ouUUID', 'employeeUUID']]); // c использованием uuid-ов объектов</p>
        <p class="listing">utils.edit(subject, ['aggr' : [ou, employee]]); // c использованием объектов</p>
        <p class="listing">//Редактируем ответственного за запрос</p>
        <p class="listing">utils.edit(subject, ['responsibleTeam' : 'teamUUID', 'responsibleEmployee' : 'employeeUUID' ]);</p>
        <p class="listing">//Редактируем значение пользовательского агрегирующего атрибута с кодом 'aggr', устанавливая сотрудника в рамках отдела (не рекомендуется т.к. не будет 
		использована логика завязанная на изменение значения агрегирующего атрибута)</p>
        <p class="listing">utils.edit(subject, ['aggr_ou' : 'ouUUID', 'aggr_em' : 'employeeUUID' ]);</p>
        <h3>Удаление значения атрибута:</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;">
            </col>
            <col style="width: 70%;">
            </col>
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                utils.clearAttribute(obj, attrCode)                            </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                                Удаление значения атрибута объекта.                            </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr"> obj</td>
                    <td>Редактируемый объект</td>
                </tr>
                <tr>
                    <td class="Metod_attr">attrCode</td>
                    <td>
                        <p>Код атрибута, у которого удаляется значение.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h3>Фильтрация атрибутов:</h3>
        <ul>
            <li value="1">
                <p>Фильтрация уникальных идентификаторов по значениям атрибутов</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                utils.filterUUIDs(uuids, attributes)                            </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Метод для фильтрации уникальных идентификаторов по значениям атрибутов                          </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">uuids</td>
                            <td>Список проверяемых uuid</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attributes</td>
                            <td>Код атрибута, значение.</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает  uuid'ы с учетом указанных ограничений по атрибутам.</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p>&#160;</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h3>Копирование атрибутов:</h3>
        <ul>
            <li value="1">
                <p>Копирование значения атрибута связанного объекта:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.copyFromRelated(subject, subjectAttr, relationAttr, attrOfRelatedObject)                           </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Копирует значения атрибута связанного объекта в атрибут текущего объекта.                         </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">subject</td>
                            <td>Объект, над которым производится действие</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">subjectAttr</td>
                            <td>Код атрибута текущего объекта, куда будет помещено значение.</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">relationAttr</td>
                            <td> Код атрибута связи типа "Ссылка на бизнес-объект".</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attrOfRelatedObject</td>
                            <td>Код копируемого атрибута связанного объекта.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Копирование значения нескольких атрибутов связанного объекта:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.copyManyLinks(subject, subjectAttr, relationAttr, attrsOfRelatedObject)                           </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Копирует значения нескольких ссылочных атрибутов связанного объекта в атрибут типа "Набор ссылок на бизнес-объект" текущего объекта.                        </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">subject</td>
                            <td>Объект, над которым производится действие</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">subjectAttr</td>
                            <td>Код атрибута текущего объекта, куда будет помещено значение.</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">relationAttr</td>
                            <td> Код атрибута связи типа "Ссылка на бизнес-объект".</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attrsOfRelatedObject</td>
                            <td>Коды копируемых атрибутов связанного объекта.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Копирование значения атрибута объекта в атрибут связанных объектов:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.copyToRelated(subject, subjectAttr, relationAttr, attrOfRelatedObject)                           </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Копирует значения нескольких ссылочных атрибутов связанного объекта в атрибут типа "Набор ссылок на бизнес-объект" текущего объекта.                        </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">subject</td>
                            <td>Объект, над которым производится действие</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">subjectAttr</td>
                            <td>Код атрибута текущего объекта.</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">relationAttr</td>
                            <td> Код атрибута связи типа "Ссылка на бизнес-объект", куда будет помещено значение..</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attrOfRelatedObject</td>
                            <td>Код копируемого атрибута</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="4">
                <p>Копирование значения атрибута объекта в атрибут вложенных объектов:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.copyToNested(subject, attr)                           </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Копирует значение атрибута объекта в атрибут вложенных объектов. Конструкция работает по всем уровням вложенности для классов, 
							вложенных в самих себя (<span class="BaseОтдел">(Undefined variable: Base.Отдел)</span> или "База знаний").       </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">subject</td>
                            <td>Объект,  у которого копируется значение атрибута</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attr</td>
                            <td>Код копируемого атрибута.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="5">
                <p>Копирование значения атрибута объекта в атрибут вложенных объектов указанного класса/типа:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.copyToChilds(subject, subjectAttr, childAttr, classOfChild, types)                           </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Копирует значение атрибута объекта в атрибут вложенных объектов указанного класса, определенных типов (все типы — пустые скобки []).
							 Конструкция работает на первом уровне вложенности для классов, у которых есть вложенные пользовательские классы.                      </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">subject</td>
                            <td>Объект,  у которого копируется значение атрибута (атрибутов)</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">subjectAttr</td>
                            <td>Код атрибута, значения которого требуется скопировать.</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">childAttr </td>
                            <td>Атрибут вложенных объектов</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">classOfChild</td>
                            <td>Класс вложенных объектов.</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">types</td>
                            <td>Типы вложенных объектов.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h3>Сравнения и проверки атрибутов</h3>
        <ul>
            <li value="1">
                <p>Проверка наличия атрибута у объекта:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                utils.containsAttribute(obj, attribute)
                            </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Проверяет наличие атрибута у объекта.
                            </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj</td>
                            <td>Объект, для которого проверяется наличие атрибута</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attribute</td>
                            <td>Код проверяемого атрибута.</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает true  при наличии атрибута, false при отсутствии атрибута.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Проверка заполнения атрибута объекта:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                utils.isFilled(obj, 'attrCode')                          <![CDATA[                            ]]></td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Проверяет заполнение атрибута объекта, при условии отличия его значения от значения по&#160;умолчанию                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Проверка равенства значения атрибута значению по умолчанию:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                utils.equalsDefaultValue(obj, 'attrCode');                          <![CDATA[                           ]]></td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Проверяет равенство значения атрибута значению по умолчанию                           </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="4">
                <p>Проверка соответствия параметров атрибута:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.utils.checkRestrictions(obj, skipRequired, skipUnique);                           </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Проверяется  заполненность обязательных и уникальных атрибутов. Предполагается, что необходимые атрибуты уже заполнены. </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj</td>
                            <td>Объект, для которого проверяется соответствие параметров атрибута</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">skipRequired, skipUnique</td>
                            <td>Логические атрибуты проверок обязательности и уникальности("true" -пропустить, "false" - не пропускать)</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="5">
                <p>Проверка  является ли элемент справочника папкой (каталогом):</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.isFolder(obj);                           </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Проверяется  является ли элемент справочника папкой (каталогом).                          </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h2><a name="naming"></a>Правила именования и нумерации объектов</h2>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>api.naming.set(metaClass, rule, int number)                         </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                        <p>
                                Метод,&#160;устанавливает нижнюю границу для соответствующего правила автоматической генерации номеров. </p>
                        <p>Типовое использование метода— выставление правильных номеров после первоначального импорта данных в систему. Данные методы не&#160;применяются 
						в случае создания объектов, атрибуты которых заполняются по правилу, указанному в параметре вызова метода.                          </p>
                    </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">metaClass</td>
                    <td>Строка</td>
                </tr>
                <tr>
                    <td class="Metod_attr">rule</td>
                    <td>Строка</td>
                </tr>
                <tr>
                    <td class="Metod_attr">int number</td>
                    <td>&#160;</td>
                </tr>
            </tbody>
        </table>
        <p>Следующий запрос, у которого правило нумерации {N}, будет создан с номером 1001:</p>
        <p class="listing">api.naming.set('serviceCall', 'N', 1000) </p>
        <p>{ND} для текущей даты будет создан с номером 1001, со следующего дня будет 1:</p>
        <p class="listing">api.naming.set('serviceCall', 'ND', 1000) </p>
        <h2><a name="utils_formatters"></a>api.utils.formatters Методы форматирования данных</h2>
        <p class="Subtitle">Замена специальные символы (&lt;, &gt;, &amp;) на их html-эквивалент:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;">
            </col>
            <col style="width: 70%;">
            </col>
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                utils.formatters.escapeHtmlSymbols(text).asString()                           </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                                Заменяет специальные символы (&lt;, &gt;, &amp;) на их html-эквивалент, чтобы они отображались в строке, как обычные символы.
						 Если text равен null, то возвращает пустой html.                           </td>
                </tr>
            </tbody>
        </table>
        <p class="Subtitle">Возврат названия объекта или его uuid, если у объекта нет атрибута "Название" (title):</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;">
            </col>
            <col style="width: 70%;">
            </col>
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                utils.formatters.format(obj)      </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td><![CDATA[
                                                          ]]></td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td>Возвращает название объекта или его uuid, если у объекта нет атрибута "Название" (title).</td>
                </tr>
            </tbody>
        </table>
        <p class="Subtitle">Методы форматирования даты и времени:</p>
        <ul>
            <li value="1">
                <p>Перевод даты в формат dd.MM.yyyy:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.formatters.formatDate(date)                          <![CDATA[                         ]]></td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает дату в формате dd.MM.yyyy.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Перевод даты/ времени в  dd.MM.yyyy HH:mm:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.formatters.formatDateTime(dateTime)                          <![CDATA[                        ]]></td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает дату/время в формате dd.MM.yyyy HH:mm.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Перевод строки в дату:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.formatters.strToDate(str, dateFormat)                       </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Переводит строку заданного формата в дату                          <![CDATA[                        ]]></td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="4">
                <p>Перевод строки формата dd.MM.yyyy HH:mm в дату:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.formatters.strToDateTime(str)                      </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Переводит строку формата dd.MM.yyyy HH:mm в дату                          <![CDATA[                       ]]></td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="5">
                <p>Перевод строки формата dd.MM.yyyy  в дату:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.formatters.strToDate(str)                          <![CDATA[                     ]]></td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Переводит строку формата dd.MM.yyyy в дату                       </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="6">
                <p>Строковое представление временного интервала:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.formatters.formatDateTimeInterval(dateTimeInterval)             
							</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает строковое представление временного интервала</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="7">
                <p>Преобразование количества миллисекунд во время ЧЧ:ММ:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.formatters.formatLongToTime(Long value, boolean roundUp).asString()                          <![CDATA[                   ]]></td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Преобразовывает количество миллисекунд во время ЧЧ:ММ (количество часов может быть больше 0 любым целым значением),
							 количество миллисекунд округляет до минут в сторону большего &lt;code&gt;true&lt;/code&gt; или меньшего &lt;code&gt;false&lt;/code&gt; значения.                          <![CDATA[                      ]]></td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="8">
                <p>Форматирование периода времени по шаблону "xx ч. yy д. zz мин.":</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.formatters.formatTimePeriod(long ms)                  </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Форматирует период времени по шаблону "xx ч. yy д. zz мин."                     </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <p class="Subtitle">Методы форматирования гиперссылки:</p>
        <ul>
            <li value="1">
                <p>Представление гиперссылки в виде текста:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.formatters.formatHyperlink(hyperlink)                          <![CDATA[                        ]]></td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает текст гиперссылки</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Форматирование гиперссылки для добавления ее на веб-страницу:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.formatters.formatHyperlinkAsHtml(hyperlink).asString()                 </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Форматирует гиперссылку для непосредственного добавления ее на страницу рабочей ссылкой.                   </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <p class="Subtitle">Методы форматирования логических значений:</p>
        <ul>
            <li value="1">
                <p>Представление гиперссылки в виде 1 и 0:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.formatters.oneZeroFormatter(booleanValue)                          <![CDATA[                       ]]></td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает 1, если значение true и 0, если значение false</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Представление гиперссылки в виде да и нет:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.formatters.yesNoFormatter(booleanValue)                          <![CDATA[                       ]]></td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает да, если значение true и нет, если значение false.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <p class="Subtitle"><a name="formatToHtml"></a>Форматирование простого текста  (text) для представления в&#160;html:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>utils.formatToHtml(subject."код атрибута")                          <![CDATA[                      ]]></td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td>Возвращает фрагмент HTML, поскольку не&#160;содержит служебных тегов. Преобразование происходит заменой переносов строк ("\n") на теги &lt;br&gt;.</td>
                </tr>
            </tbody>
        </table>
        <p>Конструкция для передачи описания запроса в оповещении: </p>
        <p class="listing">${utils.formatToHtml(subject.description)}</p>
        <h2><a name="compositeAttrs"></a>api.compositeAttrs Перерасчет значения составного атрибута</h2>
        <ul>
            <li value="1">
                <p>Пересчет значения составного атрибута в отдельном объекте</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.compositeAttrs .recalculateCompositeAttributeValue( uuid, attribute)                         </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                Пересчитывает значение составного атрибута в отдельном взятом объекте. Объект проходит валидацию в полном объеме, 
								отработают действия по событиям и т.д., как при обычном редактировании.                           </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">uuid</td>
                            <td>Уникальный идентификатор объекта, в котором будет пересчитано значение атрибута. Строка.</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attribute</td>
                            <td>Код составного атрибута, значение которого будет пересчитано. Строка.</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">api.compositeAttrs .recalculateCompositeAttributeValue( 'ad3516$96903', 'title');</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Пересчет значения составного атрибута во всех объектах определенного метакласса.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.compositeAttrs.recalculateCompositeAttributeValuesOfMetaClass(fqn, attibute)                          <![CDATA[                        ]]></td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Пересчитывает значения составного атрибута во всех объектах определенного метакласса. Без отработки действий по событиям, проверки валидации и т.д.                          <![CDATA[                           ]]></td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">fqn</td>
                            <td>fqn метакласса (строка), в объектах которого будет пересчитано значение атрибута. </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attribute</td>
                            <td>Код составного атрибута, значение которого будет пересчитано. Строка.</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">api.compositeAttrs.recalculateCompositeAttributeValuesOfMetaClass('ad3516', 'title');  </p>
                                <p class="listing">// ad3516 — класс;</p></td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h2><a name="comment"></a>Работа с комментариями</h2>
        <h3>Получение списка комментариев</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;">
            </col>
            <col style="width: 70%;">
            </col>
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>utils.comments(subject)                        </td>
                </tr>
                <tr>
                    <td>Параметр метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">subject</td>
                    <td>
                        <p>Объект, для которого отображается список комментариев.</p>
                    </td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td>Возвращает список комментариев объекта, упорядоченных хронологически (по времени добавления).</td>
                </tr>
            </tbody>
        </table>
        <h3>Удаление комментариев запроса

</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;">
            </col>
            <col style="width: 70%;">
            </col>
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>

api.db.deleteComments(dateTimeFormatter, scCreationDate, commentCreationDate, scStates)
                      </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>Метод удаляет комментарии запроса и возвращает количество удаленных комментариев
                                                          </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">dateTimeFormatter</td>
                    <td>
                        <p>Формат даты/времени, например yyyy-MM-dd HH:mm (строка). В этом формате должны быть указаны scCreationDate и scCreationDate</p>
                    </td>
                </tr>
                <tr>
                    <td class="Metod_attr">scCreationDate</td>
                    <td>Дата создания запроса (строка). Удаляются комментарии запросов, созданных ранее этой даты</td>
                </tr>
                <tr>
                    <td class="Metod_attr">commentCreationDate</td>
                    <td>Дата создания комментария (строка). Удаляются комментарии, созданные ранее этой даты</td>
                </tr>
                <tr>
                    <td class="Metod_attr">scStates</td>
                    <td>Список кодов статусов запроса (коллекция). Удаляются комментарии запросов, находящиеся в этих статусах. 
					Если ни одного статуса не указано, то удалятся комментарии во всех запросах.</td>
                </tr>
            </tbody>
        </table>
        <h2><a name="file"></a>Работа с файлами</h2>
        <h3>Получение списка файлов</h3>
        <ul>
            <li value="1">
                <p>Получение списка файлов, прикрепленных к объекту в контенте "Список файлов".</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.files(obj);                         <![CDATA[                       ]]></td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj</td>
                            <td>
                                <p>Объект, для которого отображается список файлов.</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Список  файлов, прикрепленных к объекту в контенте "Список файлов".</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Получение списка всех файлов, прикрепленных к объекту.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.allFiles(obj)                         <![CDATA[                      ]]></td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj</td>
                            <td>
                                <p>Объект или его UUID, для которого отображается список файлов.</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Список всех файлов, прикрепленных к объекту</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Получение списка всех файлов, связанных с rtf-атрибутами объекта.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.filesFromRtf(obj)                         <![CDATA[                     ]]></td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj</td>
                            <td>
                                <p>Объект или его UUID, для которого отображается список файлов.</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает список всех файлов, связанных с rtf-атрибутами объекта.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="4">
                <p>Получение списка всех файлов, связанных с определенным rtf-атрибутом объекта.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.filesFromRtf(obj, attrCode)                    </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj</td>
                            <td>
                                <p>Объект или его UUID, для которого отображается список файлов.</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attrCode</td>
                            <td>
                                <p>Код атрибута типа "Текст в формате RTF".</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Возвращает список всех файлов, связанных с определенным rtf-атрибутом объекта.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h3>Получение содержимого файла</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;">
            </col>
            <col style="width: 70%;">
            </col>
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>utils.readFileContent(file)                   </td>
                </tr>
                <tr>
                    <td>Параметр метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">file</td>
                    <td>
                        <p>Файл</p>
                    </td>
                </tr>
                <tr>
                    <td>Вызов метода:</td>
                    <td>
                        <p class="listing">def file = fileList[0] // объект типа "Файл"</p>
                        <p class="listing">try</p>
                        <p class="listing">{</p>
                        <p class="listing">byte[] data = utils.readFileContent(file)   </p>
                        <p class="listing">}</p>
                        <p class="listing">catch(e)</p>
                        <p class="listing">{</p>
                        <p class="listing">logger.error "Ошибка при чтении содержимого файла из файлового хранилища"</p>
                        <p class="listing">}</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p class="comment">Содержимое файла считывается как массив байтов. Файл не&#160;должен быть слишком большим, поскольку его содержимое
		 будет помещено в оперативную память, что может негативно сказаться на производительности системы. Не&#160;рекомендуется использовать в 
			одном скрипте вместе с методами прикрепления файлов, см.&#160;<a href="#file_add" class="MCXref xref" xrefformat="{para}">Прикрепление файлов к объекту</a>.</p>
        <h3>Получение источника данных (DataSource) для указанного файла</h3>
        <p>Источник используется для получения содержимого файла,&#160;см. <a href="#extensiveCustomOptions" class="MCXref xref" xrefformat="{para}">Отправка сообщения с широкими возможностями настройки:</a> <![CDATA[ ]]>.</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;">
            </col>
            <col style="width: 70%;">
            </col>
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>utils.getFileDataSource(file)                         <![CDATA[                  ]]></td>
                </tr>
                <tr>
                    <td>Параметр метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">file</td>
                    <td>
                        <p>Файл</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h3><a name="file_add"></a>Прикрепление файлов к объекту</h3>
        <ul>
            <li value="1">
                <p>Прикрепление файлов к объекту:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.attachFile(obj, fileName, contentType, description, data)                 </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj </td>
                            <td>
                                <p>Объект или его UUID, к которому прикрепляется файл</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">fileName</td>
                            <td>
                                <p>Название файла</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">contentType</td>
                            <td>
                                <p>Тип содержимого ('text/plain')</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">description</td>
                            <td>
                                <p>Описание фйла</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">data</td>
                            <td>
                                <p>&#160;</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Прикрепление файлов к атрибуту объекта:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.attachFile(obj, attribute, fileName, contentType, description, data)                </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj </td>
                            <td>
                                <p>Объект или его UUID, к которому прикрепляется файл</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr"> attribute</td>
                            <td>
                                <p>Код атрибута, к которому прикрепляется файла</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">fileName</td>
                            <td>
                                <p>Название файла</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">contentType</td>
                            <td>
                                <p>Тип содержимого ('text/plain')</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">description</td>
                            <td>
                                <p>Описание фйла</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">data</td>
                            <td>
                                <p>&#160;</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h2><a name="lifecycle"></a>Работа с объектам жизненным циклом</h2>
        <p>Получение статуса объекта:</p>
        <p class="listing">api.wf.state(subject)</p>
        <p>Получение списка возможных переходов из текущего статуса:</p>
        <p class="listing">api.wf.transitions(subject)</p>
        <p data-mc-conditions="Default.43">Также статус объекта может быть получен с&#160;помощью api.metainfo,
		 см.&#160;<a href="#metainfo" class="MCXref xref" xrefformat="{para}">Работа с метаинформацией</a>.</p>
        <h3>Получение истории смены статуса</h3>
        <p class="one1"> В системе хранится история смены статусов и ответственных для объектов  классов с настройкой жизненного цикла и/или ответственности.
		 История характеризуется набором атрибутов служебного класса "История изменения ответственного и статуса", набор атрибутов одинаков для всех классов и
			  расположен в карточках дочерних классов класса "История изменения ответственного и статуса".                  </p>
        <p class="one1">Нижеперечисленные методы  работают только для объектов, у которых есть жизненный цикл.</p>
        <ul>
            <li value="1">
                <p>Получение истории смены статуса:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.stateHistory(obj)                  </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj</td>
                            <td>
                                <p>Объект, для которого формируется история событий </p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Список событий смены  статуса указанного объекта. События сортируются в обратном порядке, первыми — последние изменения</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Получение события истории последней смены статуса:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.lastState(obj)                 </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj</td>
                            <td>
                                <p>Объект</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">def stateEvt = utils.lastState(obj);</p>
                                <p class="listing">def lastStateCode = stateEvt.stateCode;//код предыдущего состояния</p>
                                <p class="listing">def currentStateCode = stateEvt.newStateCode;//код текущего состояния</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h2><a name="responsible"></a>Работа с  ответственным за объект</h2>
        <h3>Назначение ответственного</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                utils.setResponsible(subject, team, employee);                            </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                                Назначение ответственного за объект.                            </td>
                </tr>
            </tbody>
        </table>
        <p class="listing"> errors = utils.setResponsible(subject, team, employee);</p>
        <p class="listing">if (!errors.isEmpty())</p>
        <p class="listing">{</p>
        <p class="listing">logger.error("Ошибка при назначении ответственного: " + errors);</p>
        <p class="listing">}</p>
        <h3>Получение истории смены ответственного </h3>
        <p class="one1"> В системе хранится история смены статусов и ответственных для объектов  классов с настройкой жизненного цикла и/или ответственности. 
		История характеризуется набором атрибутов служебного класса "История изменения ответственного и статуса", набор атрибутов одинаков для всех классов и 
			 расположен в карточках дочерних классов класса "История изменения ответственного и статуса". </p>
        <p class="one1">Нижеперечисленные методы работают только для объектов, у которых есть ответственный.</p>
        <ul>
            <li value="1">
                <p>Получение истории смены ответственного:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.responsibleHistory(obj)                  </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj</td>
                            <td>
                                <p>Объект, для которого формируется история событий </p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Список событий смены  ответственного указанного объекта. События сортируются в обратном порядке, первыми — последние изменения</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Получение события истории последней смены ответственного.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.lastResponsible(obj)                 </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj</td>
                            <td>
                                <p>Объект</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h2><a name="objetss"></a>Работа с определенными объектами</h2>
        <h3>Получения списка участников команды</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;">
            </col>
            <col style="width: 70%;">
            </col>
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>api.team.getTeamMembers(teamUUIDs, removed)                 </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">teamUUIDs</td>
                    <td>
                        <p>Коллекция уникальных идентификаторов команд</p>
                    </td>
                </tr>
                <tr>
                    <td class="Metod_attr">removed</td>
                    <td>
                        <p>Для сотрудников в архиве true, иначе — false.</p>
                    </td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td> Список UUID участников указанной команды.</td>
                </tr>
            </tbody>
        </table>
        <h3> Распространение соглашений</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;">
            </col>
            <col style="width: 70%;">
            </col>
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>api.ou.distributeAgreements(agreement, recipients)                 </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">agreement</td>
                    <td>
                        <p>Cоглашение, либо его UUID, либо коллекция соглашений, либо их UUID.</p>
                    </td>
                </tr>
                <tr>
                    <td class="Metod_attr">recipients</td>
                    <td>
                        <p>Получатели соглашения (могут быть заданы в двух вариантах). </p>
                        <ul>
                            <li value="1">Коллекция UUID получателей соглашения (сотрудник, отдел, команда). Соглашение распространяется только на указанных получателей.</li>
                            <li value="2">UUID команды или отдела. Соглашение будет распространено на  все объекты, вложенные в указанный.</li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2><a name="empl"></a>Работа персональными настройками сотрудника</h2>
        <h3>Получение персональных настроек сотрудника</h3>
        <p>Если персональные настройки сотрудника не&#160;изменялись, то перечисленные методы будут возвращать настройки по&#160;умолчанию: локаль: ru, тема
		 для интерфейса отображения: blue, часовой пояс: null.</p>
        <ul>
            <li value="1">
                <p>Получение объекта персональных настроек. </p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.employee.getPersonalSettings(employeeUuid)                </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">employeeUuid</td>
                            <td>
                                <p>Строка</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Получение кода локали: </p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>settings.getLocale();               </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td> Код локали: "ru", "en", и т.д.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Получение  кода темы  интерфейса пользователя: </p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>settings.getThemeOperator();                        <![CDATA[               ]]></td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Код темы интерфейса пользователя ("blue", "site", и т.д.).</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="4">
                <p>Получение часового пояса ("Asia/Ekaterinburg" и т.д.).: </p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>settings.getTimeZone();               </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>Часовой пояс пользователя</td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h3>Получение параметров часового пояса</h3>
        <p>Получение объекта часового пояса. Если часовой пояс, указанный в персональных настройках сотрудника, является элементом справочника "Часовые пояса"
		 или другого пользовательского справочника, то этот элемент может быть получен, как объект для последующего извлечения его параметров.</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;">
            </col>
            <col style="width: 70%;">
            </col>
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>api.employee.getTimeZone(employeeUuid)                </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                        <p>Получение объекта часового пояса. </p>
                    </td>
                </tr>
                <tr>
                    <td>Параметр метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">employeeUuid</td>
                    <td>
                        <p>Строка</p>
                    </td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td>
                        <p>Если часовой пояс является элементом справочника "Часовые пояса" или другого пользовательского справочника, то возвращает элемент справочника как объект.</p>
                        <p>Если часовой пояс не&#160;является элементом справочника "Часовые пояса" или другого пользовательского справочника, метод возвращает null.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>Получение параметров часового пояса:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <thead>
                <tr>
                    <th>Название параметра</th>
                    <th>Получение</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Код часового пояса</td>
                    <td>
                                timeZone.code;                         </td>
                </tr>
                <tr>
                    <td>Название часового пояса</td>
                    <td>
                                timeZone.getTitle();                        <![CDATA[                             ]]></td>
                </tr>
            </tbody>
        </table>
        <h3 data-mc-conditions="Default.441">Установка часового пояса для сотрудника</h3>
        <ul>
            <li value="1" data-mc-conditions="Default.441">
                <p>Часовой пояс для конкретного сотрудника:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.employee.setTimeZone(employee, timeZoneId)               </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                <p>Устанавливает часовой пояс для конкретного сотрудника. </p>
                            </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">employee</td>
                            <td>
                                <p>Сотрудник, для которого устанавливается часовой пояс. Параметр может быть задан в виде объекта или строки, содержащей его UUID.</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">timeZoneId</td>
                            <td>
                                <p>Идентификатор часового пояса.</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>
                                <p>Если часовой пояс является элементом справочника "Часовые пояса" или другого пользовательского справочника, то возвращает элемент справочника
								 как объект.</p>
                                <p>Если часовой пояс не&#160;является элементом справочника "Часовые пояса" или другого пользовательского справочника, метод возвращает null.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2" data-mc-conditions="Default.441">
                <p>Часовой пояс, указанный в родительском отделе, для сотрудников отдела:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.employee.setTimeZoneEntireOu(ou, timeZoneAttrCode)               </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                <p>Устанавливает сотрудникам отдела (включая сотрудников вложенных отделов) часовой пояс, указанный в родительском отделе. </p>
                            </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">ou</td>
                            <td>
                                <p>Отдел сотрудника. Параметр может быть задан в виде объекта или строки, содержащей его UUID.</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">timeZoneAttrCode</td>
                            <td>
                                <p>Строка с кодом атрибута типа "Элемент справочника", в котором хранится информация о часовом поясе..</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>
                                <p>Если часовой пояс является элементом справочника "Часовые пояса" или другого пользовательского справочника, то возвращает элемент
								 справочника как объект.</p>
                                <p>Если часовой пояс не&#160;является элементом справочника "Часовые пояса" или другого пользовательского справочника, метод возвращает null.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3" data-mc-conditions="Default.441">
                <p>Часовой пояс, указанный в связанном объекте, для сотрудников отдела:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.employee.setTimeZoneAccordingToLocation(ou, timeZoneAttrCode, relatedLocationAttrCode)               </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                <p>Устанавливает сотрудникам отдела часовой пояс, указанный в связанном объекте.  </p>
                            </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">ou</td>
                            <td>
                                <p>Отдел сотрудника. Параметр может быть задан в виде объекта или строки, содержащей его UUID.</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">timeZoneAttrCode</td>
                            <td>
                                <p>Строка с кодом атрибута типа "Элемент справочника", в котором хранится информация о часовом поясе.</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">relatedLocationAttrCode</td>
                            <td>
                                <p>Строка с кодом атрибута типа "Ссылка на бизнес-объект", в котором хранится информация об объекте с указанным часовым поясом.</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>
                                <p>Если часовой пояс является элементом справочника "Часовые пояса" или другого пользовательского справочника, то возвращает элемент справочника как объект.</p>
                                <p>Если часовой пояс не&#160;является элементом справочника "Часовые пояса" или другого пользовательского справочника, метод возвращает null.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h2><a name="nested_obj"></a>Работа с вложенными объектами</h2>
        <p class="one1">Для работы с вложенными объектами используются следующие методы:</p>
        <ul>
            <li value="1">
                <p><b>utils.getNested</b> — метод для получения вложенных объектов.</p>
                <p data-mc-conditions="Default.43">Особенности работы метода utils.getNested: при вызове метода, возвращается не сам объект, а только его идентификатор (UUID). </p>
            </li>
            <li value="2"><b>utils.isUpper</b> — метод для сравнения объектов в одной родительской ветке.</li>
        </ul>
        <h3>Получение вложенных объектов</h3>
        <ul>
            <li value="1">
                <p>Получение всех вложенных объектов:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.getNested(obj)                 </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Получение всех вложенных объектов (того же класса, что и родитель) на всех уровнях вложенности.
                                                          </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Получение вложенных объектов, если код атрибута-ссылки на родителя отличается от 'parent'.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.getNested(obj, parentAttrCode)                         <![CDATA[                ]]></td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Получение вложенных объектов, если код атрибута-ссылки на родителя отличается от 'parent'.                         <![CDATA[                                                          ]]></td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj</td>
                            <td>
                                <p>&#160;</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">parentAttrCode</td>
                            <td>
                                <p>Код атрибута-ссылки на родителя.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Получение сотрудников отдела.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.ou.nestedEmployees(OU)               </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">OU</td>
                            <td>Отдел, для которого ищутся сотрудники.</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td> Возвращает  UUID сотрудников отдела.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="4">
                <p>Получение вложенных отделов.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.ou.nestedOUs(OU)                         <![CDATA[              ]]></td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">OU</td>
                            <td>Отдел, для которого ищутся вложенные отделы.</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td> Возвращает  UUID отделов, вложенных в отдел.  Список результатов включает отдел OU.</td>
                        </tr>
                    </tbody>
                </table>
                <p>&#160;</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.ou.listNestedOUs(OU_UUID)                         <![CDATA[             ]]></td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">OU_UUID</td>
                            <td>UUID отдела, для которого ищутся вложенные отделы.</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td> Возвращает  UUID отделов, вложенных в отдел с UUID-ом OU_UUID.  Список результатов не&#160;включает отдел с UUID-ом OU_UUID.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h3>Определение иерархии вложенных объектов</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;">
            </col>
            <col style="width: 70%;">
            </col>
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>utils.isUpper(upper, obj)            </td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>Сравнивает объекты одного класса и определяет, находится ли upper выше по иерархии, чем obj                                                         </td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td> Возвращает  true, если upper выше, чем obj, во всех остальных случаях —false.</td>
                </tr>
            </tbody>
        </table>
        <h2><![CDATA[ ]]><a name="timing"></a>Вычисление временных характеристик и работа с счетчиками времени</h2>
        <p>Методы используются в скриптах счетчиков времени</p>
        <ul>
            <li value="1">
                <p>Получение ближайшей даты начала обслуживания:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.timing.serviceStartTime(serviceTime, timeZone)                         <![CDATA[               ]]></td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">serviceTime</td>
                            <td>Код элемента справочника "Классы обслуживания"</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">timeZone</td>
                            <td>
                                <p>Код элемента справочника "Часовые пояса"</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td> Ближайшее время начала обслуживания (на основе текущей даты).</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Получение даты окончания обслуживания:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.timing.serviceEndTime(serviceTime, timeZone, startTime, interval)               </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">serviceTime</td>
                            <td>Элемет или код элемента справочника "Классы обслуживания"</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">timeZone</td>
                            <td>
                                <p>Элемет или код элемента справочника "Часовые пояса"</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">startTime</td>
                            <td>Время, от которого необходимо начать отсчитывать период обслуживания (Date);</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">interval</td>
                            <td>
                                <p>Период обслуживания (количество миллисекунд, целое число).</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td> Время окончания обслуживания.</td>
                        </tr>
                    </tbody>
                </table>
                <p class="comment">"serviceTime" и "timeZone" либо оба являются кодом элемента справочника, либо оба — элементы справочника.</p>
            </li>
            <li value="3">
                <p>Получение регламентного периода обслуживания:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.timing.serviceTime(serviceTimeCatItem, timeZoneCatItem, startTime, endTime)                         <![CDATA[               ]]></td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Получение регламентного периода обслуживания, вычисленного по дате окончания периода обслуживания                         <![CDATA[                                                         ]]></td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">serviceTime</td>
                            <td>Элемет или код элемента справочника "Классы обслуживания"</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">timeZone</td>
                            <td>
                                <p>Элемет или код элемента справочника "Часовые пояса"</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">startTime</td>
                            <td>Время, от которого необходимо начать отсчитывать период обслуживания (Date);</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">endTime</td>
                            <td>
                                <p>Время окончания периода обслуживания</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td> Регламентный период обслуживания в миллисекундах.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="4">
                <p>Получение описания временного счетчика, используемого в атрибуте:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.timing.timerDefinition(ClassFqn fqn, String attrCode)               </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Получение описания временного счетчика, используемого в атрибуте. Данный метод будет работать корректно, если скрипт будет запущен в момент, 
							когда используемый счетчик времени активен.                                                        </td>
                        </tr>
                    </tbody>
                </table>
                <p>Для счетчика времени, полученного при помощи данного метода, можно получить следующие параметры:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <thead>
                        <tr>
                            <th>Название параметра</th>
                            <th>Получение</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Код счетчика</td>
                            <td>timerDef.getCode()                          </td>
                        </tr>
                        <tr>
                            <td>Название счетчика</td>
                            <td>
                                timerDef.getTitle()                            </td>
                        </tr>
                        <tr>
                            <td>Описание счетчика</td>
                            <td>
                                timerDef.getDescription()                            </td>
                        </tr>
                        <tr>
                            <td>Код атрибута, выбранного в поле "Промежуток времени" счетчика</td>
                            <td>timerDef.getResolutionTimeAttribute()                         </td>
                        </tr>
                        <tr>
                            <td>Код атрибута, выбранного в поле "Класс обслуживания" счетчика</td>
                            <td>timerDef.getServiceTimeAttribute()                            </td>
                        </tr>
                        <tr>
                            <td>Код атрибута, выбранного в поле "Метрика времени" счетчика</td>
                            <td>timerDef.getTimeMetric()                            </td>
                        </tr>
                        <tr>
                            <td>Код атрибута, выбранного в поле "Часовой пояс" счетчика</td>
                            <td>timerDef.getTimeZoneAttribute()                          <![CDATA[                         ]]></td>
                        </tr>
                        <tr>
                            <td>Признак архивности счетчика:</td>
                            <td>timerDef.isRemoved()                         <![CDATA[                           ]]></td>
                        </tr>
                        <tr>
                            <td>Является ли счетчик системным:</td>
                            <td>timerDef.isSystem()                               <![CDATA[                           ]]></td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="5">
                <p>Определение даты по тексту:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.timing.parseDate(text)              </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Определяет дату по тексту в формате "dd.MM.yyyy HH:mm:ss"                         <![CDATA[                                                        ]]></td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h2><a name="security"></a>Работа с правами</h2>
        <h3>Проверка наличия профиля или роли</h3>
        <ul>
            <li value="1">
                <p>Проверка наличия профиля у текущего пользователя для указанного метакласса:                        <![CDATA[	]]></p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.security.hasProfile(fqn, profile)              </td>
                        </tr>
                        <tr>
                            <td>Особенности метода:</td>
                            <td>Данная конструкция имеет ограниченное применение, она не&#160;используется для действий по&#160;событию,&#160;так как в этом случае 
							действие производится от лица суперпользователя</td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">fqn</td>
                            <td>Класс и тип объекта, для которого проверяются права. Параметр задан в виде строки, содержащей fqn типа/класса</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">profile</td>
                            <td>Профиль пользователя</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Проверка наличия профиля у текущего пользователя для указанного объекта.	</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.security.hasProfile(object, profile)              </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">object</td>
                            <td>Объект, для которого проверяются права. </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">profile</td>
                            <td>Профиль пользователя</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Проверка наличия роли у текущего пользователя для указанного объекта.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.security.hasRole(object, role)                        <![CDATA[              ]]></td>
                        </tr>
                        <tr>
                            <td>Особенности метода:</td>
                            <td>Данная конструкция имеет ограниченное применение, она не&#160;используется для действий по&#160;событию,&#160;так как в этом случае 
							действие производится от лица суперпользователя</td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">object</td>
                            <td>Объект, для которого проверяются права. </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">role</td>
                            <td>Роль пользователя</td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h3>Группы пользователей</h3>
        <ul>
            <li value="1">
                <p class="one1">Определение группы пользователей:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.security.getGroup(code)             </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">code</td>
                            <td>Код группы пользователей (строка)</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td> Возвращает группу пользователей по ее коду</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p class="one1">Определение сотрудников заданной группы пользователей:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;">
                    </col>
                    <col style="width: 70%;">
                    </col>
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.security.getAllEmployees(groups)             </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr"> groups</td>
                            <td>Группы пользователей </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td> Возвращает коллекцию UUID всех сотрудников из заданных групп пользователей.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h2><a name="mail"></a>Работа с почтой</h2>
        <h3><a name="Отправка"></a>Отправка сообщения</h3>
        <p class="Subtitle">Отправка текстового сообщения:	</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>api.mail.sender.send (email, title, subject, message[, contentType]) </td>
                </tr>
                <tr>
                    <td>Описание</td>
                    <td>
                        <p>Метод отправляет сообщение с учетом транзакции (сообщения отправляются, только если транзакция будет зафиксирована).  </p>
                    </td>
                </tr>
                <tr>
                    <td>Метод:</td>
                    <td>api.mail.simpleSender.send(email, title, subject, message[, contentType])</td>
                </tr>
                <tr>
                    <td>Описание</td>
                    <td>
                        <p>Метод отправляет сообщение вне контекста транзакции </p>
                    </td>
                </tr>
                <tr>
                    <td>Параметры методов:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">email</td>
                    <td>e-mail, на который будет отправляться сообщение</td>
                </tr>
                <tr>
                    <td class="Metod_attr">title</td>
                    <td>Имя получателя</td>
                </tr>
                <tr>
                    <td class="Metod_attr">subject</td>
                    <td>Тема сообщения</td>
                </tr>
                <tr>
                    <td class="Metod_attr">message</td>
                    <td>Содержание сообщения</td>
                </tr>
                <tr>
                    <td class="Metod_attr">contentType</td>
                    <td>Тип сообщения, может быть "text/plain" или "text/html"</td>
                </tr>
            </tbody>
        </table>
        <p>Отправка сообщения нескольким получателям:	</p>
        <p class="listing">api.mail.sender.send(['email1' :'title1', 'email2' : 'title2'], subject, message, contentType);</p>
        <p class="listing">api.mail.simpleSender.send(['email1' :'title1', 'email2' : 'title2'], subject, message, contentType);</p>
        <p class="Subtitle"><a name="mailSender"></a>Создание и отправка сообщения:</p>
        <ul>
            <li value="1">
                <p>Создание объекта почтового сообщения:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.mail.sender.createMail()</td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p>
                                Метод создает объект почтового сообщения.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Отправка созданного сообщения:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.mail.sender.sendMail(message)</td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p>
                                Метод отправляет созданное сообщение.</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">message</td>
                            <td>Содержание сообщения</td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <p><a name="extensiveCustomOptions"></a>Отправка сообщения с широкими возможностями настройки:</p>
        <p class="listing">def message = api.mail.sender.createMail() //создает объект почтового сообщения</p>
        <p class="listing">message.addTo('Имя получателя №1', 'address1@mail.com')  //добавляет получателя (поле письма "Кому")</p>
        <p class="listing">message.addCc('Имя получателя №2', 'address2@mail.com')  //добавляет получателя в&#160;копию</p>
        <p class="listing">message.addBcc('Имя получателя №3', 'address3@mail.com') //добавляет получателя в&#160;скрытую копию</p>
        <p class="listing">message.addReplyTo('Имя', 'reply-to@mail.com') //добавляет адрес replyTo</p>
        <p class="listing">message.setFrom('Имя отправителя', 'from@mail.com') //задает адрес отправителя</p>
        <p class="listing">message.setSubject('Тема сообщения') //устанавливает тему сообщения</p>
        <p class="listing">message.setText('Тело сообщения') //устанавливает текст сообщения</p>
        <p class="listing">message.addText('\n\nПодпись') //дописывает текст в конец тела сообщения</p>
        <p class="listing">message.contentType = 'text/plain' //задает тип содержимого письма</p>
        <p class="listing">&#160;</p>
        <p class="listing">def file = ... // системный объект класса "Файл" (file)</p>
        <p class="listing">def source = utils.getFileDataSource(file) // получаем источник данных для объекта file</p>
        <p class="listing">message.attachFile(source) // прикрепляем файл к сообщению (также можно прикрепить два и более файлов)</p>
        <p class="listing">&#160;</p>
        <p class="listing">api.mail.sender.sendMail(message) //отправка созданного сообщения</p>
        <h3><a name="messageMail"></a>Обработка почты</h3>
        <p class="Subtitle">Получение параметров входящего сообщения:</p>
        <ul>
            <li value="1">
                <p>Список получателей письма:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <thead>
                        <tr>
                            <th>Метод</th>
                            <th>Описание</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>message.getRecipientsAsString() </td>
                            <td> Метод возвращает строку-список всех адресов получателей через символ ";".                        </td>
                        </tr>
                        <tr>
                            <td>message.getToAsString()</td>
                            <td>Метод возвращает строку-список адресов получателей, указанных в поле "Кому" (TO).                           </td>
                        </tr>
                        <tr>
                            <td>message.getCcAsString() </td>
                            <td>Метод возвращает строку-список адресов получателей, указанных в поле "Копия" (CC).                     <![CDATA[                          ]]></td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Параметры отправителя:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <thead>
                        <tr>
                            <th>Метод</th>
                            <th>Описание</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>message.getFrom().getAddress()</td>
                            <td> Метод возвращает адрес отправителя сообщения.                     <![CDATA[                       ]]></td>
                        </tr>
                        <tr>
                            <td>message.getFrom().getName()</td>
                            <td>Метод возвращает имя отправителя сообщения.                     <![CDATA[                          ]]></td>
                        </tr>
                        <tr>
                            <td>message.getFrom().getDomain() </td>
                            <td>Метод возвращает домен отправителя сообщения (часть адреса после "@").                     <![CDATA[                         ]]></td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Параметры почтового сообщения:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <thead>
                        <tr>
                            <th>Метод</th>
                            <th>Описание</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>message.getHeaders().get("название_заголовка")</td>
                            <td>Метод возвращает  заголовок сообщения.</td>
                        </tr>
                        <tr>
                            <td>message.getSubject()</td>
                            <td>Метод возвращает тему сообщения.</td>
                        </tr>
                        <tr>
                            <td>message.getBody() </td>
                            <td>Метод возвращает тело сообщения как обычный текст.</td>
                        </tr>
                        <tr>
                            <td>message.getHtmlBody() </td>
                            <td> Метод возвращает тело сообщения как html-текст, который не&#160;содержит обрамляющих тегов (&lt;html&gt; и &lt;body&gt; и др.), 
							а также потенциально опасных тегов.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="4">
                <p>Список вложений и параметры вложения:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <thead>
                        <tr>
                            <th>Метод</th>
                            <th>Описание</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>message.getAttachments</td>
                            <td>Метод возвращает список файлов, прикрепленных к письму.</td>
                        </tr>
                        <tr>
                            <td>attachment.getFilename()</td>
                            <td>Метод возвращает имя файла (обычно короткое имя с расширением).</td>
                        </tr>
                        <tr>
                            <td>attachment.getContentType()</td>
                            <td>Метод возвращает MIME-тип содержимого файла.</td>
                        </tr>
                        <tr>
                            <td>attachment.getData() </td>
                            <td> Метод возвращет массив байтов содержимого фйла.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h3><a name="resultMail"></a>Методы работы с результатами обработки входящего сообщения</h3>
        <p>Получение результата отправки письма:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>result.isSuccessfull() </td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td>
                        <p>
                                Метод возвращает true, если письмо не&#160;отклонено (rejected) и не&#160;ошибка (error). Иначе false.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p class="Subtitle">Статусы почтового сообщения:</p>
        <ul>
            <li value="1">
                <p> Получение статуса почтового сообщения:	</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>result.getMessageState()</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>
                                <p>
                                 Метод возвращает статус сообщения.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p> Назначение статуса почтового сообщения:	</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>result.setMessageState(messageState) </td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p> Метод назначает статус сообщения.  </p>
                            </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">messageState</td>
                            <td>Статус почтового сообщения. Может иметь следующие значения:</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">&#160;</td>
                            <td>api.mail.ERROR_MSG_STATE — обработка сообщения закончилась ошибкой;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">&#160;</td>
                            <td>api.mail.REJECT_MSG_STATE — сообщение было отклонено;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">&#160;</td>
                            <td>api.mail.NEW_BO_MSG_STATE — при обработке сообщения был создан новый бизнес-объект;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">&#160;</td>
                            <td>api.mail.ATTACH_MSG_STATE — обрабатываемое сообщение было прикреплено к существующему бизнес-объекту;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">&#160;</td>
                            <td>api.mail.OUTGOING_MSG_STATE — другое.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <p class="Subtitle">Отклонение письма:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <thead>
                <tr>
                    <th>Метод</th>
                    <th>Описание</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>result.isRejected() </td>
                    <td> Метод возвращает true, если письмо отклонено (rejected). Иначе false.</td>
                </tr>
                <tr>
                    <td>result.getRejectReason()</td>
                    <td> Метод возвращает причину отклонения письма.</td>
                </tr>
                <tr>
                    <td>result.getRejectMessage() </td>
                    <td>Метод возвращает текстовое описание причины отклонения.</td>
                </tr>
                <tr>
                    <td>&#160;</td>
                    <td>&#160;</td>
                </tr>
            </tbody>
        </table>
        <p class="Subtitle">Отклонение письма с указанием причины:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>result.reject(reason[; message]) </td>
                </tr>
                <tr>
                    <td>Описание</td>
                    <td>
                        <p> Метод отклоняет письмо с указанием причины. </p>
                    </td>
                </tr>
                <tr>
                    <td>Параметр метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">reason</td>
                    <td>Причина отклонения. Может иметь следующие значения:</td>
                </tr>
                <tr>
                    <td class="Metod_attr">&#160;</td>
                    <td>api.mail.BAD_ATTACHMENTS_REJECT_REASON — к сообщению прикреплены несоответствующие вложения;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">&#160;</td>
                    <td>api.mail.INVALID_EMAIL_REJECT_REASON — указан некорректный e-mail адрес;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">&#160;</td>
                    <td>api.mail.BIG_ATTACHMENT_REJECT_REASON — к сообщению прикреплено слишком большое вложение;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">&#160;</td>
                    <td>api.mail.BAD_FORMAT_REJECT_REASON — несоответствующий формат сообщения;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">&#160;</td>
                    <td>api.mail.CLIENT_NOT_FOUND_REJECT_REASON — не&#160;удалось определить клиента для запроса;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">&#160;</td>
                    <td>api.mail.CONTACT_NOT_FOUND_REJECT_REASON — не&#160;удалось определить контактное лицо для запроса;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">&#160;</td>
                    <td>api.mail.BLACKLIST_REJECT_REASON —  входит в черный список;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">&#160;</td>
                    <td>api.mail.OTHER_REJECT_REASON —  другая причина.</td>
                </tr>
                <tr>
                    <td class="Metod_attr">message</td>
                    <td>Cтатус почтового сообщения</td>
                </tr>
            </tbody>
        </table>
        <p class="Subtitle">Получение информации об ошибке при обработке письма:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 300px;" />
            <col style="width: 70%;" />
            <thead>
                <tr>
                    <th>Метод</th>
                    <th>Описание</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>result.isError()</td>
                    <td>  Метод возвращает true, если есть ошибка&#160;(error). Иначе false</td>
                </tr>
                <tr>
                    <td>result.getErrorMessage()</td>
                    <td>Текстовое описание ошибки:</td>
                </tr>
            </tbody>
        </table>
        <p class="Subtitle">Проверка допустимых и недопустимых типов вложений:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>api.mail.hasBadAttachment(message, acceptableExtensions, exceptableExtensions)  </td>
                </tr>
                <tr>
                    <td>Описание</td>
                    <td>
                        <p>Метод проверяет допустимые и недопустимые типы вложений в сообщении.</p>
                        <p>Данный метод не&#160;влияет на системную проверку наличия в письме недопустимых вложений с расширениями: "exe", "com", "bin". 
						Если в письме есть хоть одно вложение с указанным расширением, то письмо будет отклонено.</p>
                    </td>
                </tr>
                <tr>
                    <td>Параметр метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">message</td>
                    <td>Проверяемое сообщение</td>
                </tr>
                <tr>
                    <td class="Metod_attr">acceptableExtensions</td>
                    <td>Список допустимых расширений файлов во вложении письма, может быть пуст</td>
                </tr>
                <tr>
                    <td class="Metod_attr">exceptableExtensions</td>
                    <td>Cписок недопустимых расширений файлов во вложении письма,&#160;может быть пуст</td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td>  Метод возвращает true, если в письме есть хоть одно вложение с&#160;недопустимым расширением. Иначе false.</td>
                </tr>
            </tbody>
        </table>
        <p>Пример скрипта для правил обработки входящей почты:</p>
        <p class="listing">//Допустимые расширения файлов во вложении письма</p>
        <p class="listing">def acceptableExtensions = ['gif', 'jpg', 'png', 'htm', 'html', 'txt'];</p>
        <p class="listing">//Недопустимые расширения файлов во вложении письма</p>
        <p class="listing">def exceptableExtensions = ['exe', 'com', 'bin'];</p>
        <p class="listing">if (api.mail.hasBadAttachment(message, acceptableExtensions, exceptableExtensions))</p>
        <p class="listing">{</p>
        <p class="listing">logger.error('Входящее письмо содержит недопустимые файлы во вложении!');</p>
        <p class="listing">}</p>
        <p class="listing">else</p>
        <p class="listing">{</p>
        <p class="listing">logger.info('Входящее письмо не&#160;содержит недопустимых файлов во вложении.');</p>
        <p class="listing">}</p>
        <h3>Вспомогательные методы для работы с почтой</h3>
        <p class="Subtitle">Прикрепление входящего сообщения к объекту:	</p>
        <ul>
            <li value="1">
                <p> Прикрепление входящего сообщения:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.mail.helper.attachMessage(subject, message)</td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                <p>
                                 Метод прикрепляет входящее сообщение к объекту</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Результат выполения метода:</td>
                            <td>
                                <p>
                                Входящее сообщение прикрепляется как файл .eml, для просмотра файла используется почтовый клиент.</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">subject</td>
                            <td>Объект, к которому прикрепляется сообщение или его вложения</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">message</td>
                            <td>Входящее сообщение</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p><![CDATA[ ]]><a name="helper_attach"></a>Прикрепление вложений из входящего сообщения:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.mail.helper.attachMessageAttachments(subject, message) </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                <p>
                                 Метод прикрепляет вложения из входящего сообщения к объекту. Файлы изображения, вложенные в само письмо, пропускаются.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p> Прикрепление вложений из входящего сообщения, включая  изображения:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.mail.attachAllMessageAttachments(subject, message) </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                <p>
                                  Метод прикрепляет все вложения из входящего сообщения к объекту, включая вложенные в текст письма изображения.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <p class="Subtitle">Преобразование  в формате HTML:	</p>
        <ul>
            <li value="1">
                <p>Очищение html от потенциально опасных тегов:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.mail.helper.sanitizeHtml(htmlText) </td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                <p>
                                 Метод очищает html от потенциально опасных тегов и делает содержимое пригодным для использования внутри атрибута типа richtext, 
									см. также <a href="#formatToHtml" class="MCXref xref" xrefformat="{para}">Форматирование простого текста  (text) для представления в&#160;html:</a></p>
                            </td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">String htmlText = ...</p>
                                <p class="listing">htmlText = api.mail.helper.sanitizeHtml(htmlText)</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Замена ссылок на составные части письма:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.mail.helper.replaceReferencesToAttachments(message)</td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>
                                <p>
                                 Метод преобразует содержание письма в формате HTML: заменяет ссылки на составные части письма (например, содержимое картинки) 
									ссылками на прикрепленные файлы. </p>
                                <p>Данный метод следует использовать после прикрепления всех вложений входящего сообщения message к объекту subject:
								 api.mail.helper.attachMessageAttachments(subject, message) см.&#160;<a href="#helper_attach" class="MCXref xref" xrefformat="{para}"> Прикрепление вложений из входящего сообщения:</a></p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <p class="Subtitle">Проверка электронного адреса на корректность:	</p>
        <p>Сравнение, поиск, изменение, удаление e-mail адресов производятся без учета регистра.</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 300px;" />
            <col style="width: 70%;" />
            <thead>
                <tr>
                    <th>Метод</th>
                    <th>Описание</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>api.mail.helper.isValidEmail(email)</td>
                    <td>  Метод возвращает true, если адрес корректен. Иначе false.</td>
                </tr>
                <tr>
                    <td>api.mail.helper.isInvalidEmail(email) </td>
                    <td>Метод возвращает null, если адрес корректен. Иначе сообщение об ошибке.</td>
                </tr>
                <tr>
                    <td>api.mail.helper.isSystemEmailAddress(email)                      <![CDATA[ ]]></td>
                    <td>
                        <p>Метод проверяет электронный адрес на принадлежность к электронному адресу системы.  Метод возвращает true, если проверяемый email 
						является электронным адресом системы (сообщения, отправляемые системой, имеют from с указанным адресом). Иначе false.</p>
                        <p>В сообщениях, отправляемых системой, в поле "from" указан e-mail адрес системы, который задан в настройке исходящей почты.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p class="Subtitle">Получение адреса технической поддержки:	</p>
        <p class="listing"> api.mail.helper.feedbackAddress</p>
        <p class="Subtitle">Поиск сотрудника по  e-mail адресу:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>api.mail.helper.searchEmployeeByEmail(email)</td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td>
                        <p>Сотрудник — если найден только один сотрудник;
 null — если не&#160;найдено ни одного сотрудника; генерирует исключение — если найдено более одного сотрудника.</p>
                        <p><![CDATA[                                 ]]></p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p class="Subtitle">Генерация события "Поступление письма":	</p>
        <p class="listing">api.mail.helper.notifyMailReceived(scall) </p>
        <p class="Subtitle"><a name="SilentMode"></a>Проверка режима SilentMode:</p>
        <p>SilentMode — режим, в котором приложение перестает получать и отправлять почту. Режим определяется в конфигурационном файле dbaccess.properties.</p>
        <p>Скрипт для проверки, находится ли приложение в режиме SilentMode:</p>
        <p class="listing">if ( api.mail.silentMode ) {</p>
        <p class="listing">// SilentMode</p>
        <p class="listing">}</p>
        <h2><a name="reports"></a>Работа с отчетами и печатными формами</h2>
        <h3>Генерация отчета/печатной формы  по шаблону в определенном формате и отправка его по почте</h3>
        <ul>
            <li value="1">
                <p>Генерация отчета/печатной формы  по шаблону в определенном формате и отправка его по почте:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.reports.getReportDataSource(templateCode, subjectUUID, parametersValues, format)</td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p>
                                Генерация по шаблону отчета/печатной формы  в определенном формате.  Сгенерированный отчет/печатная форма может использоваться для отправки по почте. </p>
                            </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">templateCode</td>
                            <td>Код шаблона отчета/печатной формы</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">subjectUUID</td>
                            <td>uuid объекта, относительно которого строится отчет/печатная форма (для использования переменной subject в отчетах)</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">parametersValues</td>
                            <td>Map значений параметров &lt;Код параметра, Значение параметра&gt;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">format</td>
                            <td>
                                <p>Формат отчета/печатной формы, допустимые параметры: "pdf", "xlsx", "csv", "zip".</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>Скрипт для генерации и отправки по почте отчета в формате pdf:</p>
                <p class="listing">def templateCode = 'marks';//код шаблона отчета</p>
                <p class="listing">def RECIPIENT = 'test@naumen.ru' //адрес получателя</p>
                <p class="listing">def Format='pdf'</p>
                <p class="listing">&#160;</p>
                <p class="listing">def message = api.mail.sender.createMail() //создание объекта почтового сообщения</p>
                <p class="listing">message.addTo('Имя получателя №1', RECIPIENT)  //добавление получателя (поле письма "Кому")</p>
                <p class="listing">message.addReplyTo('Имя', RECIPIENT) //добавление адреса replyTo</p>
                <p class="listing">message.setFrom('Имя отправителя', RECIPIENT) //задает адрес отправителя</p>
                <p class="listing">message.setSubject('Тема сообщения') //установка темы сообщения</p>
                <p class="listing">message.setText(api.reports.getReportLink(templateCode, 'root$101', ['DateFrom': new Date(), 'DateTo': new Date()+1])) //установка текста сообщения</p>
                <p class="listing">message.contentType = 'text/plain' //задает тип содержимого письма</p>
                <p class="listing">def fileTitle = 'test.'+Format;</p>
                <p class="listing">&#160;</p>
                <p class="listing">message.attachFile(api.reports.getReportDataSource(templateCode, 'root$101', ['DateFrom': new Date(), 'DateTo': new Date()+1], Format),fileTitle);</p>
                <p class="listing">api.mail.sender.sendMail(message)</p>
            </li>
            <li value="2">
                <p>Генерация отчета/печатной формы  по шаблону в нескольких форматах и отправка его по почте:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.reports.getReportDataSources(templateCode, subjectUUID, parametersValues, formats)</td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p>
                                Генерация по шаблону отчета/печатной формы  в определенных форматах.  Сгенерированный отчет/печатная форма может использоваться для отправки по почте. </p>
                            </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">templateCode</td>
                            <td>Код шаблона отчета/печатной формы</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">subjectUUID</td>
                            <td>uuid объекта, относительно которого строится отчет/печатная форма (для использования переменной subject в отчетах)</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">parametersValues</td>
                            <td>Map значений параметров &lt;Код параметра, Значение параметра&gt;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">formats</td>
                            <td>
                                <p>Форматы отчета/печатной формы. Допустимые параметры: "pdf", "xlsx", "csv", "zip".</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>Скрипт для генерации и отправки по почте отчета в нескольких форматах:</p>
                <p class="listing">def templateCode = 'marks';//код шаблона отчета</p>
                <p class="listing">def RECIPIENT = 'test@naumen.ru' //Адрес получателя</p>
                <p class="listing">def FORMATS=['pdf','xls','csv', 'htmlZip']</p>
                <p class="listing">&#160;</p>
                <p class="listing">def message = api.mail.sender.createMail() //создание объекта почтового сообщения</p>
                <p class="listing">message.addTo('Имя получателя №1', RECIPIENT)  //добавление получателя (поле письма "Кому")</p>
                <p class="listing">message.addReplyTo('Имя', RECIPIENT) //добавляет адрес replyTo</p>
                <p class="listing">message.setFrom('Имя отправителя', RECIPIENT) //задает адрес отправителя</p>
                <p class="listing">message.setSubject('Тема сообщения') //установка темы сообщения</p>
                <p class="listing">message.setText(api.reports.getReportLink(templateCode, 'root$101', ['DateFrom': new Date(), 'DateTo': new Date()+1])) //установка текста сообщения</p>
                <p class="listing">message.contentType = 'text/plain' //задает тип содержимого письма</p>
                <p class="listing">&#160;</p>
                <p class="listing">def sources =  api.reports.getReportDataSources(templateCode, 'root$101', ['DateFrom': new Date(), 'DateTo': new Date()+1], FORMATS)// получаем источник данных для объекта file</p>
                <p class="listing">sources.each</p>
                <p class="listing">{ key, value -&gt;</p>
                <p class="listing">def fileTitle = (key == 'htmlZip' ? 'ReportFileName.zip' : 'ReportFileName.'+key);</p>
                <p class="listing">message.attachFile(value, fileTitle);</p>
                <p class="listing">}</p>
                <p class="listing">api.mail.sender.sendMail(message)</p>
            </li>
        </ul>
        <h3>Генерация ссылки на карточку экземпляра отчета/печатной формы, построенного по шаблону</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>api.reports.getReportLink(templateCode, subjectUUID, parametersValues)</td>
                </tr>
                <tr>
                    <td>Описание</td>
                    <td>
                        <p>Генерация ссылки на карточку экземпляра отчета/печатной формы, построенного по указанному шаблону.</p>
                    </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">templateCode</td>
                    <td>Код шаблона отчета/печатной формы</td>
                </tr>
                <tr>
                    <td class="Metod_attr">subjectUUID</td>
                    <td>uuid объекта, относительно которого строится отчет/печатная форма (для использования переменной subject в отчетах)</td>
                </tr>
                <tr>
                    <td class="Metod_attr">parametersValues</td>
                    <td>Map значений параметров &lt;Код параметра, Значение параметра&gt;</td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td>Строка, содержащая URL-ссылку на карточку указанного отчета/печатной формы .</td>
                </tr>
            </tbody>
        </table>
        <h3>Получение названия отчета</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>api.reports.getTemplateTitle(templateCode)</td>
                </tr>
                <tr>
                    <td>Параметр метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">templateCode</td>
                    <td>Код шаблона отчета/печатной формы</td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td>Название шаблона отчета/печатной формы. Если шаблона отчета/печатной формы  с указанным кодом нет,то возвращает пустую строку</td>
                </tr>
            </tbody>
        </table>
        <h3>Проверка параметров отчета</h3>
        <ul>
            <li value="1">
                <p>Проверка наличия в отчете параметра с указанным кодом:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.reports.hasParameter(templateCode, parameter)</td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p>Проверяет наличие в шаблоне отчета/печатной формы параметра с указанным кодом. </p>
                            </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">templateCode</td>
                            <td>Код шаблона отчета/печатной формы</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">parameter</td>
                            <td>Код параметра отчета/печатной формы</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>true — если параметр с указанным кодом существует; false — если параметра с указанным кодом не&#160;существует, если шаблона отчета/печатной формы  с указанным кодом не&#160;существует</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Проверка наличия в отчете параметров с указанным кодом:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.reports.hasParameters(templateCode, parameter)</td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p>Проверяет наличие в шаблоне отчета/печатной формы параметров с указанным кодом. </p>
                            </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">templateCode</td>
                            <td>Код шаблона отчета/печатной формы</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">parameters</td>
                            <td>Коды параметров отчета/печатной формы</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>true — если параметры с указанными кодами существует; false — если параметров с указанными кодами не&#160;существует, если шаблона отчета/печатной формы  с указанным кодом не&#160;существует</td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h2><a name="displayingMessages"></a>Вывод пользовательских сообщений об ошибке</h2>
        <ul>
            <li value="1">
                <p>Вывод сообщения в интерфейс пользователя.</p>
                <p>В скрипте условии на вход/выход из статуса и скрипте условии действия по событию используется конструкция:</p>
                <p class="listing">return "message"</p>
            </li>
            <li value="2">
                <p>Вывод пользовательского сообщения об ошибке в лог.</p>
                <p>В скрипте действия при входе/выходе в/из статуса используется следующий метод:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>utils.throwReadableException(message, Object... args) </td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p>Выводит в лог пользовательское сообщение об ошибке (message). В&#160;интерфейс пользователя выводится стандартное системное сообщение об ошибке</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">message</td>
                            <td>Формат сообщения об ошибке для лога(строка) </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">Object... args</td>
                            <td>Аргументы к формату сообщения</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3" data-mc-conditions="Default.444">
                <p>Вывод различных пользовательских сообщений  в интерфейсе пользователя и в логе (консоли):</p>
                <p data-mc-conditions="Default.444">

В скрипте условии на вход в статус, скрипте действия при входе в статус, а так же в скриптах синхронных действий по событию используется следующий метод:.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr data-mc-conditions="Default.444">
                            <td>Метод:</td>
                            <td>utils.throwReadableException(message, Object[] messageArgs, uiMessage, Object[] uiMessageArgs)</td>
                        </tr>
                        <tr data-mc-conditions="Default.444">
                            <td>Описание</td>
                            <td>
                                <p>Выводит различные пользовательские сообщения об ошибке (message) в интерфейс пользователя и в лог.</p>
                            </td>
                        </tr>
                        <tr data-mc-conditions="Default.444">
                            <td>Параметры метода:</td>
                            <td>Форматы сообщений должны соответствовать спецификации java.util.Formatter.
Так же допускается указывать обычный текст вместо форматов. В этом случае следует вместо массива аргументов указывать null.
</td>
                        </tr>
                        <tr data-mc-conditions="Default.444">
                            <td class="Metod_attr">message</td>
                            <td>Формат сообщения об ошибке для лога(строка) </td>
                        </tr>
                        <tr data-mc-conditions="Default.444">
                            <td class="Metod_attr">Object[] messageArgs</td>
                            <td>Аргументы к формату сообщения для лога</td>
                        </tr>
                        <tr data-mc-conditions="Default.444">
                            <td class="Metod_attr">uiMessage</td>
                            <td>Формат сообщения об ошибке для интерфейса пользователя (строка)</td>
                        </tr>
                        <tr data-mc-conditions="Default.444">
                            <td class="Metod_attr">Object[] uiMessageArgs</td>
                            <td>Аргументы к формату сообщения для интерфейса пользователя</td>
                        </tr>
                        <tr data-mc-conditions="Default.444">
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">
utils.throwReadableException("Сообщение для отображения %s.", new String[]{"в логе"}, "Строка для показа в %s %s.", new String[]{"пользовательском", "интерфейсе"});</p>
                                <p>Результатом будут следующие сообщения:</p>
                                <ul>
                                    <li value="1"> для лога: "Сообщение для отображения в логе." </li>
                                    <li value="2">для интерфейса пользователя: "Строка для показа в пользовательском интерфейсе." </li>
                                </ul>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h2><a name="db"></a>Обращение к базе данных</h2>
        <h3>Использование запросов к базе данных:</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                api.db.query </td>
                </tr>
                <tr>
                    <td>Описание</td>
                    <td>
                        <p>
                                Метод,&#160;позволяющий писать запросы к базе данных со сложной логикой фильтрации с использованием языка запросов <a href="http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch16.html" target="_blank">HQL</a>.</p>
                        <p class="one1">Описание структуры таблиц базы данных приводится в документе "Структура базы данных <span class="BaseProductName">(Undefined variable: Base.ProductName)</span>".</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>Получение id  запросов, которые содержат в описании "все методы":</p>
        <p class="listing">def q = api.db.query('select id from serviceCall where description like :d');</p>
        <p class="listing">q.set('d', '%все методы%');</p>
        <p class="listing">def ids = q.list();</p>
        <h3>Фильтрация атрибутов:</h3>
        <p>Обращение к СУБД во время генерации элементов фильтруемого списка</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;">
            </col>
            <col style="width: 70%;">
            </col>
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                api.filters                            </td>
                </tr>
                <tr>
                    <td>Описание</td>
                    <td>
                        <p>
                                Метод позволяет обращаться напрямую к СУБД во время генерации элементов фильтруемого списка. </p>
                        <p>Метод работает только для скриптов фильтрации невложенных бизнес-объектов (раскрывающийся список, а не дерево).</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>Фильтрация запросов по автору и услуге:</p>
        <p class="listing">def author = ...</p>
        <p class="listing">def service = ..</p>
        <p class="listing">api.filters.eq('serviceCall', ["author" : author, "service" : service])</p>
        <h2><a name="http"></a>Выполнение запросов к внешним сервисам</h2>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                api.http.postJSON(url, data) </td>
                </tr>
                <tr>
                    <td>Описание</td>
                    <td>
                        <p>
                                Выполняет JSON-запрос к внешнему сервису методом HTTP POST. Максимальное время ожидания ответа от ресурса — 3 сек. Ожидаемая кодировка содержимого — UTF-8.</p>
                    </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">url</td>
                    <td>Адрес ресурса. URL должен быть в URL-закодированном виде </td>
                </tr>
                <tr>
                    <td class="Metod_attr"> data</td>
                    <td>Map с параметрами запроса, которые передаются в теле запроса, преобразуясь в JSON перед отправкой. Типы данных в Map'е с параметрами должны быть примитивными (String, Integer, Float, Double, Boolean).</td>
                </tr>
                <tr>
                    <td>Результат выполнения метода:</td>
                    <td>Метод ожидает ответ в формате JSON от внешнего сервиса. Запрос отправляется HTTP-методом POST. Результат выполнения метода — Map содержащая JSON-данные ответа сервиса.</td>
                </tr>
            </tbody>
        </table>
        <p class="listing">api.http.postJSON('http://ya.ru', ['key':'value'])</p>
        <p class="listing">// В теле запроса будет передана строка {key:value}</p>
        <h2><a name="search_reindex"></a>Переиндексация полнотекстового поиска</h2>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                api.search.reindexAll()                        <![CDATA[ ]]></td>
                </tr>
                <tr>
                    <td>Описание</td>
                    <td>
                        <p>
                                Переиндексация полнотекстового поиска. Индексация запускается асинхронно по метаклассам с разбивкой по&#160;500&#160;объектов</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p class="note">Полная или частичная переиндексация объектов при больших объемах данных может занимать продолжительное время. Во время переиндексации производительность системы может быть снижена.  Рекомендуется запускать переиндексацию в периоды минимальной нагрузки системы, в нерабочее время.</p>
        <h2><a name="advimport"></a>Работа с импортом</h2>
        <h3>Остановка импорта</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                api.advimport.stop('advimportConfig')</td>
                </tr>
                <tr>
                    <td>Описание</td>
                    <td>
                        <p>
                                Останавливает выполнение активной конфигурации импорта. </p>
                    </td>
                </tr>
                <tr>
                    <td>Параметр метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">advimportConfig</td>
                    <td>
                        <p> Идентификатор конфигурации импорта. Идентификатор импорта указывается в адресной строке карточки конфигурации:</p>
                        <p>../sd/admin/#advImportConfig:<b>f0e05190-145d-0247-0000-00007388e0bf</b></p>
                    </td>
                </tr>
                <tr>
                    <td>Результат выполнения метода:</td>
                    <td>
                        <p>В случае успешной остановки импорта в лог системы и лог импорта записывается сообщение, действия (создание/модификация объектов), выполненные импортом до момента остановки, не&#160;отменяются. В случае если конфигурация импорта с указанным идентификатором отсутствует или не&#160;запущена, выводится сообщение об ошибке.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>Остановка активной конфигурации импорта (идентификатор конфигурации импорта — f0e05190-145d-0247-0000-00007388e0bf):</p>
        <p class="listing">api.advimport.stop('f0e05190-145d-0247-0000-00007388e0bf')</p>
        <h3 data-mc-conditions="Default.447_449"><a name="advimport.start"></a>Запуск импорта</h3>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr data-mc-conditions="Default.447_449">
                    <td data-mc-conditions="Default.447_449">Метод:</td>
                    <td data-mc-conditions="Default.447_449">
                                api.advimport.start(advimportConfig, parameters)</td>
                </tr>
                <tr data-mc-conditions="Default.447_449">
                    <td data-mc-conditions="Default.447_449">Описание</td>
                    <td>
                        <p data-mc-conditions="Default.447_449">
                                Запуск конфигурации импорта из скрипта обработки входящей почты. При запуске можно указать параметры запуска импорта.</p>
                    </td>
                </tr>
                <tr data-mc-conditions="Default.447_449">
                    <td data-mc-conditions="Default.447_449">Параметр метода:</td>
                    <td data-mc-conditions="Default.447_449">&#160;</td>
                </tr>
                <tr data-mc-conditions="Default.447_449">
                    <td class="Metod_attr" data-mc-conditions="Default.447_449">advimportConfig</td>
                    <td data-mc-conditions="Default.447_449">
                        <p data-mc-conditions="Default.447_449"> Идентификатор конфигурации импорта. </p>
                        <p>Идентификатор импорта указывается в адресной строке карточки конфигурации:</p>
                        <p>../sd/admin/#advImportConfig:<b>f0e05190-145d-0247-0000-00007388e0bf</b></p>
                    </td>
                </tr>
                <tr data-mc-conditions="Default.447_449">
                    <td class="Metod_attr" data-mc-conditions="Default.447_449">parameters</td>
                    <td data-mc-conditions="Default.447_449">
                        <p data-mc-conditions="Default.447_449">Параметры запуска импорта (gui-parameter конфигурации импорта). </p>
                        <p data-mc-conditions="Default.447_449">
Допустимые типы значения параметров:
</p>
                        <ul>
                            <li value="1">
                                <p>STRING — используется для передачи:</p>
                                <ul style="list-style-type: circle;">
                                    <li value="1"> строки для заполнения строковых параметров;</li>
                                    <li value="2">UUID файла источника данных для импорта (file$1234);</li>
                                    <li value="3">
                                        <p> содержимого файла источника данных для импорта.</p>
                                    </li>
                                </ul>
                            </li>
                            <li value="2">byte[] и InputStream — используется для передачи содержимого файла источника данных для импорта.</li>
                        </ul>
                    </td>
                </tr>
                <tr data-mc-conditions="Default.447_449">
                    <td data-mc-conditions="Default.447_449">Результат выполнения метода:</td>
                    <td>
                        <p data-mc-conditions="Default.447_449">Запуск конфигурации импорта.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p data-mc-conditions="Default.447_449">Пример запуска конфигурации импорта без параметров (f0e05190-145d-0247-0000-00007388e0bf — идентификатор конфигурации импорта, [:] — пустые параметры запуска):</p>
        <p class="listing" data-mc-conditions="Default.447_449">api.advimport.start('f0e05190-145d-0247-0000-00007388e0bf', [:]);</p>
        <p data-mc-conditions="Default.447_449">Пример запуска конфигурации импорта с использованием UUID файла в качестве источника импорта и строкового параметра.
</p>
        <p class="listing" data-mc-conditions="Default.447_449">api.advimport.start('f0e05190-145d-0247-0000-00007388e0bf', [ 'fileForProcess' : 'file$1234', 'defaultValue' : 'defaultString' ]);</p>
        <p data-mc-conditions="Default.447_449">Пример запуска конфигурации импорта с использованием вложения письма в качестве источника импорта (byte[]).
</p>
        <p class="listing" data-mc-conditions="Default.447_449">api.advimport.start('f0e05190-145d-0247-0000-00007388e0bf', [ 'fileForProcess' : message.getAttachments()[0].getData() ]);

 </p>
        <p data-mc-conditions="Default.447_449">Из скрипта обработки почты:</p>
        <p class="listing" data-mc-conditions="Default.447_449">def startImport(def message)
</p>
        <p class="listing" data-mc-conditions="Default.447_449">{
    </p>
        <p class="listing" data-mc-conditions="Default.447_449">for (def attachment : message.getAttachments())
    </p>
        <p class="listing" data-mc-conditions="Default.447_449">{</p>
        <p class="listing" data-mc-conditions="Default.447_449">
        logger.debug("Filename is: " + attachment.getFilename() + " content type is : " + attachment.getContentType());
        </p>
        <p class="listing" data-mc-conditions="Default.447_449">try {</p>
        <p class="listing" data-mc-conditions="Default.447_449">
            api.advimport.start('advImportConfig:f9157637-14c7-0d65-0000-00005e6f5b10', [ 'fileForProcess' : attachment.getData() ]);
</p>
        <p class="listing" data-mc-conditions="Default.447_449">        }</p>
        <p class="listing" data-mc-conditions="Default.447_449">
        catch(e) {
</p>
        <p class="listing" data-mc-conditions="Default.447_449">            logger.error("Error ${e.message}");
        </p>
        <p class="listing" data-mc-conditions="Default.447_449">}</p>
        <p class="listing" data-mc-conditions="Default.447_449">
    }
</p>
        <p class="listing" data-mc-conditions="Default.447_449">}</p>
        <h2><a name="fileStorage"></a>Работа с файловыми хранилищами</h2>
        <ul style="list-style-type: circle;">
            <li value="1">
                <p>Сжатие файлов в хранилище:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.fileStorage.compressAll</td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p>
                                Сжатие всех файлов, ранее добавленных в хранилище.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Перемещение файлов:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.fileStorage.moveAll</td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p>
                                Перемещение всех ранее добавленных файлов из одного хранилища в другое.</p>
                                <p>Если в хранилище есть поврежденные файлы, то такие файлы не&#160;перемещаются. Остальные неповрежденные файлы переносятся в другое файловое хранилище.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Повторное чтение настроек файлового хранилища:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.fileStorage.reload </td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p>
                                Повторное чтение конфигурационного файла настроек файлового хранилища.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h2><a name="password"></a>Шифрование и дешифрования паролей</h2>
        <p>Шифрование паролей включается и отключается в файле  <![CDATA[ ]]>.</p>
        <ul>
            <li value="1">
                <p>Метод шифрования паролей:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.encryption.encryptAllPasswords()</td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p>
                                Зашифровывает и пересохраняет все пароли, задаваемые через интерфейс технолога. Работает только в случае, если шифрование паролей в данный момент включено. В противном случае в лог будет выведено сообщение об ошибке.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Метод шифрования произвольной строки.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.encryption.encryptString(string)</td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p>
                                Зашифровывает произвольную строку.</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">string</td>
                            <td> Строка, которую нужно зашифровать.</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>
                                <p>Зашифрованная строка.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Метод дешифрования паролей.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>
                                api.encryption.decryptAllPasswords()</td>
                        </tr>
                        <tr>
                            <td>Описание</td>
                            <td>
                                <p>Расшифровывает и пересохраняет все пароли, задаваемые через интерфейс технолога. Работает только в случае, если шифрование паролей  в данный момент отключено. В противном случае в лог будет выведено сообщение об ошибке. </p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <h2><a name="sms"></a>Отправка SMS</h2>
        <p>Метод api.sms.sendSms используется для отправки SMS сообщений.</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>
                                api.sms.sendSms(from, phone, message)</td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>
                        <p>Отправляет SMS&#160;сообщение. </p>
                    </td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">from</td>
                    <td>Автор сообщения.</td>
                </tr>
                <tr>
                    <td class="Metod_attr">phone</td>
                    <td>Номер телефона, на который будет отослано SMS сообщение.</td>
                </tr>
                <tr>
                    <td class="Metod_attr">message</td>
                    <td>Текст SMS сообщения.</td>
                </tr>
            </tbody>
        </table>
        <p>Для работы с методом api.sms необходимо добавить параметры подключения к SMS сервису в конфигурационный файл:</p>
        <ul style="list-style-type: circle;">
            <li value="1">sms.host // хост;</li>
            <li value="2">sms.port //порт;</li>
            <li value="3">sms.login //логин;</li>
            <li value="4">sms.password //пароль.</li>
        </ul>
        <h2><a name="ldap"></a>Работа с LDAP</h2>
        <ul>
            <li value="1">
                <p>Установление соединения с сервером LDAP:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.ldap.open(url, user, passwd)</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">def ctx = api.ldap.open("ldap://localhost:389/", "cn=admin,dc=localhost", "123");</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Поиск записи в LDAP:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Методы:</td>
                            <td>
                                <p>ctx.search(baseDn, filter)</p>
                                <p>ctx.search(baseDn, searchAttributes)</p>
                                <p>ctx.search(baseDn, searchAttributes, attributesToReturn)</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">def result = ctx.search("ou=test,dc=localhost", "(sn=" + oldSubject.lastName + ")")</p>
                                <p class="listing">def result = ctx.search("ou=test,dc=localhost", ['sn' : oldSubject.lastName ])</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Создание записи в LDAP:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>ctx.create(dn, objectClass, attributes)</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">ctx.create("cn=" + subject.lastName + ",ou=test,dc=localhost",</p>
                                <p class="listing">['inetOrgPerson', 'top' ],</p>
                                <p class="listing">['givenName' : subject.firstName,</p>
                                <p class="listing">'sn' : subject.lastName ,</p>
                                <p class="listing">'cn' : subject.lastName ]);</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="4">
                <p>Редактирование записи в LDAP:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>ctx.edit(dn, attributes)</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">ctx.edit("cn=" + subject.lastName + ",ou=test,dc=localhost", [ 'givenName' : subject.firstName ]);</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="5">
                <p>Удаление записи в  LDAP:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>ctx.delete(dn);</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">ctx.delete("cn=" + oldSubject.lastName + ",ou=test,dc=localhost");</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="6">
                <p>Переименование записи в  LDAP:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>ctx.rename(oldDn, newDn)</td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <p>Cкрипт для изменения сотрудника, который модифицирует соответствующую ему запись в&#160;LDAP, или создает новую, если такой записи нет.</p>
        <p class="listing">def ctx = api.ldap.open("ldap://localhost:389/", "cn=admin,dc=localhost", "123");</p>
        <p class="listing">def r = ctx.search("ou=test,dc=localhost", ['cn' : subject.lastName]);</p>
        <p class="listing">if (r.size() == 0) {</p>
        <p class="listing">ctx.create("cn=" + subject.lastName + ",ou=test,dc=localhost",</p>
        <p class="listing">[ 'inetOrgPerson', 'top' ],</p>
        <p class="listing">[ 'givenName' : subject.firstName,</p>
        <p class="listing">'sn' : subject.lastName ,</p>
        <p class="listing">'cn' : subject.lastName ]);</p>
        <p class="listing">} else {</p>
        <p class="listing">ctx.edit("cn=" + subject.lastName + ",ou=test,dc=localhost",</p>
        <p class="listing">[ 'givenName' : subject.firstName ]);</p>
        <p class="listing">}</p>
        <h2><a name="metainfo"></a>Работа с метаинформацией</h2>
        <ul style="list-style-type: square;">
            <li value="1">
                <p>Получение метакласса.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.metainfo.getMetaClass(obj)</td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj</td>
                            <td>fqn метакласса, либо строковое представление метакласса, либо объект, либо метакласс.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Проверка существование метакласса.</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.metainfo.metaClassExists(obj)</td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">obj</td>
                            <td>fqn метакласса, либо строковое представление метакласса, либо объект, либо метакласс.</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Получение всех типов заданного класса (список метаклассов).</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.metainfo.getTypes(fqn)</td>
                        </tr>
                        <tr>
                            <td>Параметр метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">fqn</td>
                            <td>fqn метакласса</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="4">
                <p>Проверка наличия атрибута:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.metainfo.checkAttributeExisting(fqn, attribute)</td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Проверяет наличие атрибута с заданным кодом в метаклассе</td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">fqn</td>
                            <td>fqn метакласса либо строковое представление метакласса, либо объект, либо метакласс;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attribute</td>
                            <td>Код атрибута.</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>
                                <p>Если атрибут существует, то пустая строка; если атрибута не&#160;существует, то сообщение об&#160;ошибке</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="5">
                <p>Проверка наличия нескольких атрибутов:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.metainfo.checkAttrsExisting(fqn, attributes)</td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Проверяет наличие нескольких атрибутов с заданным кодом в метаклассе.</td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">fqn</td>
                            <td>fqn метакласса либо строковое представление метакласса, либо объект, либо метакласс;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attributes</td>
                            <td>Коды атрибутов.</td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>
                                <p>Если все атрибуты существует, то пустая строка; если хотя бы одного атрибута не&#160;существует, то сообщение об&#160;ошибке.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="6">
                <p>Проверка соответствия типа атрибута:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.metainfo.checkAttributeType(fqn, attribute, possibleTypes)</td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Проверяет соответствие типа атрибута одному из списка possibleTypes.</td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">fqn</td>
                            <td>fqn метакласса либо строковое представление метакласса, либо объект, либо метакласс;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attribute</td>
                            <td>Код атрибута.</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">possibleTypes</td>
                            <td>
                                <p>Список:</p>
                                <p class="listing">//def possibleTypes = ['object', 'boLinks'];</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>
                                <p>Если список possibleTypes содержит код типа проверяемого атрибута, то пустая строка; если не&#160;содержит, то сообщение об&#160;ошибке.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="7">
                <p>Проверка соответствия типа атрибута одному из списка:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.metainfo.checkAttrsType(fqn, attributes)</td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Проверяет соответствие типа атрибута одному из списка, заданного для этого атрибута.</td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">fqn</td>
                            <td>fqn метакласса либо строковое представление метакласса, либо объект, либо метакласс;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">attributes</td>
                            <td>
                                <p>Список:</p>
                                <p class="listing">//def attributes = ['agreement': ['object', 'boLinks'], 'qweqtqr' : ['string']];       </p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>
                                <p>Если для всех атрибутов выполняется условие: список кодов типов содержит код типа проверяемого атрибута, то пустая строка; если не&#160;содержит, то сообщение об&#160;ошибке..</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        </ul>
        <p class="Subtitle">Методы обращения к свойствам метакласса:</p>
        <p class="note">Методы обращения к свойствам метакласса доступны после получения самого метакласса.</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 300px;" />
            <col style="width: 70%;" />
            <thead>
                <tr>
                    <th>Метод</th>
                    <th>Описание</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>title</td>
                    <td>  возвращает название метакласса:</td>
                </tr>
                <tr>
                    <td>getAttribute(String code) </td>
                    <td>возвращает атрибут метакласса по коду</td>
                </tr>
                <tr>
                    <td>attributeCodes</td>
                    <td>возвращает коллекцию кодов всех атрибутов метакласса</td>
                </tr>
                <tr>
                    <td>attributeGroupCodes</td>
                    <td> возвращает коллекцию кодов групп атрибутов</td>
                </tr>
                <tr>
                    <td>attributeGroups</td>
                    <td>возвращает коллекцию групп атрибутов</td>
                </tr>
                <tr>
                    <td>attributes</td>
                    <td>возвращает коллекцию атрибутов;</td>
                </tr>
                <tr>
                    <td>children</td>
                    <td>возвращает список метаклассов-подтипов первого уровня вложености, т.е. метаклассы, родителем которых является данный метакласс; </td>
                </tr>
                <tr>
                    <td>code</td>
                    <td>возвращает код метакласса, например, serviceCall$incident;</td>
                </tr>
                <tr>
                    <td>description</td>
                    <td>возвращает описание</td>
                </tr>
                <tr>
                    <td>fqn </td>
                    <td>объект, идентифицирующий метакласс: getCase() — код типа; id — код класса.</td>
                </tr>
                <tr>
                    <td>fqnCase</td>
                    <td>возвращает код типа метакласса;</td>
                </tr>
                <tr>
                    <td>parent</td>
                    <td>возвращает родителя (метакласс);</td>
                </tr>
                <tr>
                    <td>workflow</td>
                    <td>возвращает объект жизненного цикла;</td>
                </tr>
                <tr>
                    <td>hasAttribute(String code)</td>
                    <td>возвращает true, если у метакласса есть атрибут с указанным кодом, иначе  false;</td>
                </tr>
                <tr>
                    <td>hasWorkflow</td>
                    <td> возвращает true, если у метакласса есть жизненный цикл, иначе  false;</td>
                </tr>
                <tr>
                    <td>hasResponsible</td>
                    <td>логическое значение, есть ли в метаклассе механизм передачи ответственного</td>
                </tr>
            </tbody>
        </table>
        <p>Получение названия типа объекта:</p>
        <p class="listing">api.metainfo.getMetaClass(subject).title</p>
        <p>Получение названия класса объекта:</p>
        <p class="listing">api.metainfo.getMetaClass(subject.metaClass.id).title</p>
        <p class="Subtitle">Методы обращения к атрибутам метакласса:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 300px;" />
            <col style="width: 70%;" />
            <thead>
                <tr>
                    <th>Метод</th>
                    <th>Описание</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>title</td>
                    <td>  возвращает название атрибута</td>
                </tr>
                <tr>
                    <td>code</td>
                    <td>возвращает код атрибута</td>
                </tr>
                <tr>
                    <td>type</td>
                    <td>возвращает тип атрибута</td>
                </tr>
                <tr>
                    <td>declaredMetaClass</td>
                    <td>возвращает метакласс, в котором этот атрибут создан</td>
                </tr>
                <tr>
                    <td>defaultValue</td>
                    <td>возвращает значение по умолчанию (если значение по умолчанию является вычислимым, то возвращает null); </td>
                </tr>
                <tr>
                    <td>hasDefaultValue </td>
                    <td>логическое значение, определено ли значение по умолчанию </td>
                </tr>
                <tr>
                    <td>filteredByScript </td>
                    <td>логическое значение, фильтруется скриптом</td>
                </tr>
                <tr>
                    <td>computable</td>
                    <td>проверяет, является ли атрибут вычислимым; </td>
                </tr>
                <tr>
                    <td>required </td>
                    <td>проверяет, является ли атрибут обязательным</td>
                </tr>
                <tr>
                    <td>unique</td>
                    <td>проверяет, является ли атрибут уникальным</td>
                </tr>
            </tbody>
        </table>
        <p>Название атрибута метакласса</p>
        <p class="listing">api.metainfo.getMetaClass(subject).getAttribute(attrCode).title</p>
        <p>Метод для получения кода типа атрибутов: code — возвращает код типа атрибута.</p>
        <p class="Subtitle">Методы обращения к группам атрибутов метакласса:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 300px;" />
            <col style="width: 70%;" />
            <thead>
                <tr>
                    <th>Метод</th>
                    <th>Описание</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>title</td>
                    <td>  возвращает название группы атрибутов</td>
                </tr>
                <tr>
                    <td>code</td>
                    <td>возвращает код группы атрибутов; </td>
                </tr>
                <tr>
                    <td>attributeCodes</td>
                    <td> возвращает список кодов атрибутов, входящих в группы</td>
                </tr>
            </tbody>
        </table>
        <p class="Subtitle">Методы получения статуса жизненного цикла:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 300px;" />
            <col style="width: 70%;" />
            <thead>
                <tr>
                    <th>Метод</th>
                    <th>Описание</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>endState</td>
                    <td>возвращает конечный статус</td>
                </tr>
                <tr>
                    <td>originalState</td>
                    <td>первоначальный статус, с которым создается объект;</td>
                </tr>
                <tr>
                    <td>getState(String code)</td>
                    <td>возвращает статус по коду; </td>
                </tr>
                <tr>
                    <td>states</td>
                    <td>возвращает список статусов;</td>
                </tr>
                <tr>
                    <td>isTransitionExists(beginState, endState)</td>
                    <td>проверяет наличие разрешенного перехода из состояния beginState в endState, где beginState и endState — либо коды статусов, либо статусы как объекты.</td>
                </tr>
            </tbody>
        </table>
        <p>Также см. <a href="#lifecycle" class="MCXref xref" xrefformat="{para}">Работа с объектам жизненным циклом</a>.</p>
        <p class="Subtitle">Методы обращения к свойствам статуса жизненного цикла:</p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 300px;" />
            <col style="width: 70%;" />
            <thead>
                <tr>
                    <th>Метод</th>
                    <th>Описание</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>title</td>
                    <td>  возвращает название статуса</td>
                </tr>
                <tr>
                    <td>code</td>
                    <td>возвращает код статуса                     <![CDATA[ ]]></td>
                </tr>
                <tr>
                    <td>description</td>
                    <td> возвращает описание статуса; </td>
                </tr>
                <tr>
                    <td>enabled</td>
                    <td> проверяет доступность.</td>
                </tr>
            </tbody>
        </table>
        <p>Получение названия текущего статуса объекта:</p>
        <p class="listing">api.metainfo.getMetaClass(subject).workflow.getState(subject.state).title </p>
        <h2><a name="cti"></a>Методы модуля CTI</h2>
        <h3>Методы для организации интеграции с телефонией</h3>
        <p>Методы api.cti работают при продключени модуля CTI и служат для организации интеграции с телефонией на стороне <span class="BaseProductName">(Undefined variable: Base.ProductName)</span>.</p>
        <ul>
            <li value="1" data-mc-conditions="Default.443">
                <p>Проверка доступности оператора:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.cti.isListenMessages(user.login)</td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Проверяет, что сотрудник находится в командах, ответственных за телефонию, авторизован в системе и находится в интерфейсе пользователя</td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">login</td>
                            <td>Логин сотрудника - оператора телефонии</td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="2">
                <p>Открытие URL в браузере оператора телефонии:</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.cti.open(login, url, mode)</td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Выполняет открытие url в браузере оператора телефонии.</td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">login</td>
                            <td>Логин <MadCap:conditionalText data-mc-conditions="Default.443">сотрудника - оператора телефонии, в браузере которого будет открыта ссылка</MadCap:conditionalText>.</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">url</td>
                            <td>
                                <p>URL карточки контрагента, формируется через  <![CDATA[ ]]>.</p>
                                <p class="listing">def url = api.web.baseUrl + "#search:101";</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">mode</td>
                            <td>
                                <p>Pежим открытия карточки контрагента: в текущем окне/вкладке — "current", в новом — "new".</p>
                                <p>Место, где открывается карточка: вкладка или окно, зависит от&#160;настройки браузера.</p>.</td>
                        </tr>
                        <tr>
                            <td>Вызов метода:</td>
                            <td>
                                <p class="listing">api.cti.open(user.login, url, mode)</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>Открытие карточки контрагента в новом окне/вкладке:</p>
                <p class="listing">api.cti.open('user101', api.web.open('ou$1601'), 'new')</p>
                <p>Открытие карточки контрагента на текущей вкладке/окне:</p>
                <p class="listing">api.cti.open('user205', api.web.open('ou$401'), 'current')</p>
            </li>
            <li value="3">
                <p>Выполнение звонка из интерфейса <span class="BaseProductName">(Undefined variable: Base.ProductName)</span> (Работает только для интеграции с Asterisk).</p>
                <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                    <col style="width: 20%;" />
                    <col style="width: 70%;" />
                    <tbody>
                        <tr>
                            <td>Метод:</td>
                            <td>api.cti.makeCall(src, dst, ['context':'ext-group'])</td>
                        </tr>
                        <tr>
                            <td>Описание:</td>
                            <td>Обращается к серверу IP-телефонии и инициирует звонок от src к dst. </td>
                        </tr>
                        <tr>
                            <td>Параметры метода:</td>
                            <td>&#160;</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">src</td>
                            <td>Номер звонящего абонента.</td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">dst</td>
                            <td>
                                <p>Номер телефона, на который совершается вызов.</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="Metod_attr">'context':'ext-group'</td>
                            <td>
                                <p>Параметр используется, если звонок осуществляется на групповой номер. Означает, что номер, на который совершается вызов, является групповым и находится в&#160;контексте ext-group.</p>
                            </td>
                        </tr>
                        <tr>
                            <td>Возвращаемое значение:</td>
                            <td>
                                <p>Метод передает на сервер IP-телефонии номер телефона, в котором удалены все пробелы, дефисы и/или тире, открывающие и закрывающие скобки, а также все знаки +, за исключением первого в номере. На сервере IP-телефонии инициируется звонок.</p>
                                <p>Метод возвращает ошибку, в следующих случаях: </p>
                                <ul>
                                    <li value="1">если в номере телефона присутствуют символы, отличные от пробела, дефиса/тире, плюса и скобок. Звонок на сервере телефонии не&#160;инициируется.</li>
                                    <li value="2">сервер телефонии на инициацию звонка ответил какой-либо ошибкой или сервер не&#160;доступен.</li>
                                </ul>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <li value="3">
                    <p>Переподключение к серверу телефонии (Работает только для интеграции с Asterisk).</p>
                    <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
                        <col style="width: 20%;" />
                        <col style="width: 70%;" />
                        <tbody>
                            <tr>
                                <td>Метод:</td>
                                <td>api.cti.reconnect();</td>
                            </tr>
                            <tr>
                                <td>Описание:</td>
                                <td>Выполняет переподключение к серверу телефонии, может быть полезен для перезагрузки интеграции. </td>
                            </tr>
                        </tbody>
                    </table>
                </li>
            </li>
        </ul>
        <h3>Метод для получения  информации о звонках</h3>
        <p>Метод для получения информации о звонках работает только для интеграции с Asterisk. </p>
        <table style="width: 90%;margin-left: 0;margin-right: auto;caption-side: top;mc-caption-repeat: true;mc-caption-continuation: '(продолжение)';">
            <col style="width: 20%;" />
            <col style="width: 70%;" />
            <tbody>
                <tr>
                    <td>Метод:</td>
                    <td>api.cdr.search(filter)</td>
                </tr>
                <tr>
                    <td>Описание:</td>
                    <td>Возвращает с сервера IP-телефонии информацию о звонках, которые удовлетворяют заданным параметрам. cdr — CallDetailRecord в Asterisk.</td>
                </tr>
                <tr>
                    <td>Параметры метода:</td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td class="Metod_attr">filter</td>
                    <td>
                        <p>Набор критериев для поиска звонков. Представляет собой ассоциативный массив. Доступные ключи:</p>
                        <ul>
                            <li value="1"><b>id</b> — идентификатор звонка на сервере телефонии;</li>
                            <li value="2"><b>src</b> — номер звонящего абонента;</li>
                            <li value="3"><b>dst</b> — номер телефона, на который звонящий совершал вызов;</li>
                            <li value="4"><b>connected</b> — номер абонента, с которым звонящий вел разговор;</li>
                            <li value="5"><b>dateFrom</b> — дата совершения звонка "C";</li>
                            <li value="6"><b>dateTo</b> — дата совершения звонка "По".</li>
                        </ul>
                        <p>Форматы дат: yyyy.MM.dd HH:mm:ss, yyyy.MM.dd HH:mm, yyyy.MM.dd</p>
                    </td>
                </tr>
                <tr>
                    <td>Возвращаемое значение:</td>
                    <td>
                        <p>Для каждого звонка возвращается следующая информация — идентификатор звонка, время начала разговора (время поднятие трубки), продолжительность разговора в секундах, номер абонента, с которым звонящий вел разговор, номер телефона, на который звонящий совершал вызов, номер звонящего абонента и ссылка на запись разговора.</p>
                        <p>Запись разговора хранится на сервере. Сервер телефонии предоставляет возможность получить доступ к файлу по ссылке.</p>
                    </td>
                </tr>
                <tr>
                    <td>Вызов метода:</td>
                    <td>
                        <p class="listing">api.cdr.search([dateFrom": "2014.01.29 06:00:00", "dateTo": "2014.01.30 06:00:00"])</p>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>
