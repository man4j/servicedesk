function ChatWidget(a){if(!(typeof a.url==="undefined")&&!(a.url===null)){nsdLiveChatSettings.nsdUrl=a.url}if(!(typeof a.mode==="undefined")&&!(a.mode===null)){nsdLiveChatSettings.mode=a.mode}if(!(typeof a.buttonColor==="undefined")&&!(a.buttonColor===null)){nsdLiveChatSettings.buttonColor=a.buttonColor}if(!(typeof a.hoverButtonColor==="undefined")&&!(a.hoverButtonColor===null)){nsdLiveChatSettings.hoverButtonColor=a.hoverButtonColor}if(!(typeof a.activeButtonColor==="undefined")&&!(a.activeButtonColor===null)){nsdLiveChatSettings.activeButtonColor=a.activeButtonColor}if(!(typeof a.mainBackgroundColor==="undefined")&&!(a.mainBackgroundColor===null)){nsdLiveChatSettings.mainBackgroundColor=a.mainBackgroundColor}if(!(typeof a.clientColor==="undefined")&&!(a.clientColor===null)){nsdLiveChatSettings.clientColor=a.clientColor}if(!(typeof a.operatorColor==="undefined")&&!(a.operatorColor===null)){nsdLiveChatSettings.operatorColor=a.operatorColor}if(!(typeof a.windowsHeight==="undefined")&&!(a.windowsHeight===null)){nsdLiveChatSettings.windowsHeight=a.windowsHeight}if(!(typeof a.windowsWidth==="undefined")&&!(a.windowsWidth===null)){nsdLiveChatSettings.windowsWidth=a.windowsWidth}if(!(typeof a.openChatButtonColor==="undefined")&&!(a.openChatButtonColor===null)){nsdLiveChatSettings.openChatButtonColor=a.openChatButtonColor}if(!(typeof a.openChatActiveButtonColor==="undefined")&&!(a.openChatActiveButtonColor===null)){nsdLiveChatSettings.openChatActiveButtonColor=a.openChatActiveButtonColor}if(!(typeof a.openChatHoverButtonColor==="undefined")&&!(a.openChatHoverButtonColor===null)){nsdLiveChatSettings.openChatHoverButtonColor=a.openChatHoverButtonColor}$(document).ready(function(){nsdLiveChatEntryPoint.init()})}var nsdLiveChatSettings={nsdUrl:"http://localhost:8888",mode:"bottomRight",buttonColor:"#3397db",hoverButtonColor:"#0fabff",activeButtonColor:"#2385c7",mainBackgroundColor:"#ebeff1",clientColor:"#666666",operatorColor:"#3397da",windowsHeight:"500px",windowsWidth:"360px",openChatButtonColor:"#3397db",openChatActiveButtonColor:"#2385c7",openChatHoverButtonColor:"#0fabff",chatWidgetUrl:function(){return nsdLiveChatSettings.nsdUrl+"/chat/?buttonColor="+encodeURIComponent(nsdLiveChatSettings.buttonColor)+"&hoverButtonColor="+encodeURIComponent(nsdLiveChatSettings.hoverButtonColor)+"&activeButtonColor="+encodeURIComponent(nsdLiveChatSettings.activeButtonColor)+"&mainBackgroundColor="+encodeURIComponent(nsdLiveChatSettings.mainBackgroundColor)+"&clientColor="+encodeURIComponent(nsdLiveChatSettings.clientColor)+"&operatorColor="+encodeURIComponent(nsdLiveChatSettings.operatorColor)}};var nsdLiveChatEntryPoint={init:function(){$.ajax({type:"GET",url:nsdLiveChatSettings.nsdUrl+"/services/rest-livechat/livechat-info",dataType:"jsonp",contentType:"application/json",jsonpCallback:"onLiveChatInfoLoaded"})}};function onLiveChatInfoLoaded(a){nsdLiveChat.liveChatInfo=a;if(a.isLiveChatAvailable&&!nsdLiveChat.exists()){nsdLiveChat.init()}}function onLiveChatInfoLoaded2(a){nsdLiveChat.liveChatInfo=a;if(nsdLiveChat.liveChatInfo.hasOnlineUsers){setButtonOnline()}else{setButtonOffline()}}function setButtonOnline(){$("#"+nsdLiveChat.labelId).removeClass("offline").addClass("online");$(".consultant-unavailable").html("Онлайн-консультант");$(".leave-message").html("ЗАДАТЬ ВОПРОС")}function setButtonOffline(){$("#"+nsdLiveChat.labelId).removeClass("online").addClass("offline");$(".consultant-unavailable").html("Онлайн-консультант недоступен");$(".leave-message").html("ОСТАВИТЬ СООБЩЕНИЕ")}var nsdLiveChat={id:"nsdLiveChat",labelId:"nsdLiveChatLabel",iframeId:"nsdLiveChatIframe",expanded:false,liveChatInfo:{},expand:function(){nsdLiveChat.hideLabel(function(){nsdLiveChat.mode().expand();nsdLiveChat.iframe().attr("src",nsdLiveChatSettings.chatWidgetUrl());nsdLiveChat.show()});expanded=true},collapse:function(){nsdLiveChat.hide(function(){$.ajax({type:"GET",url:nsdLiveChatSettings.nsdUrl+"/services/rest-livechat/livechat-info",dataType:"jsonp",contentType:"application/json",jsonpCallback:"onLiveChatInfoLoaded2",data:{number:"2"}});nsdLiveChat.mode().collapse();nsdLiveChat.iframe().attr("src","");nsdLiveChat.showLabel()});expanded=false},show:function(a){nsdLiveChat.get().css("display","block");nsdLiveChat.get().animate({opacity:1},300,"linear",a)},hide:function(a){nsdLiveChat.get().animate({opacity:0},300,"linear",function(){nsdLiveChat.get().css("display","none");a()})},showLabel:function(a){nsdLiveChat.label().css("display","block");nsdLiveChat.label().animate({opacity:1},300,"linear",a)},hideLabel:function(a){nsdLiveChat.label().animate({opacity:0},300,"linear",function(){nsdLiveChat.label().css("display","none");a()})},init:function(){$("body").append(nsdLiveChatTemplates.liveChat());$("body").append(nsdLiveChatTemplates.liveChatLabel());$("#"+nsdLiveChat.labelId).on("mousedown",function(a){a.preventDefault()});$(".nsd-chat-container .close").on("mousedown",function(a){a.preventDefault()});$("<style type='text/css'> .nsd-chat-container .close{     background-color:  "+nsdLiveChatSettings.buttonColor+";}.nsd-chat-container .close:hover{    background-color:  "+nsdLiveChatSettings.hoverButtonColor+";}.nsd-chat-container .close:active{    background-color:  "+nsdLiveChatSettings.activeButtonColor+";}.nsd-livechat-button{    background:  "+nsdLiveChatSettings.openChatButtonColor+";}.nsd-livechat-button:hover{    background:  "+nsdLiveChatSettings.openChatHoverButtonColor+";}.nsd-livechat-button:active, .nsd-livechat-button.active{    background:  "+nsdLiveChatSettings.openChatActiveButtonColor+";}</style>").appendTo("head");nsdLiveChat.get().css("right","30px");nsdLiveChat.get().css("left","auto");nsdLiveChat.get().css("bottom","0");nsdLiveChat.get().css("top","auto");nsdLiveChat.get().css("height",nsdLiveChatSettings.windowsHeight);nsdLiveChat.get().css("width",nsdLiveChatSettings.windowsWidth);nsdLiveChat.get().css("min-width","360px");nsdLiveChat.get().css("min-height","500px");nsdLiveChat.mode().init();nsdLiveChat.iframe().attr("src","");nsdLiveChat.label().click(function(){if(!nsdLiveChat.expanded){nsdLiveChat.expand()}});$(".nsd-livechat-button").mousedown(function(){$(this).toggleClass("active",true)});$(".nsd-livechat-button").mouseup(function(){$(this).toggleClass("active",false)});$(".nsd-livechat-button").mouseleave(function(){$(this).toggleClass("active",false)});$(".nsd-chat-container .close, .nsd-chat-container button").click(function(){if(!nsdLiveChat.expanded){nsdLiveChat.collapse()}});nsdLiveChat.showLabel()},get:function(){return $("#"+nsdLiveChat.id)},label:function(){return $("#"+nsdLiveChat.labelId)},iframe:function(){return $("#"+nsdLiveChat.iframeId)},exists:function(){if($("#"+nsdLiveChat.id).length){return true}return false},mode:function(){return modes[nsdLiveChatSettings.mode]},};var nsdLiveChatTemplates={liveChat:function(){var a="";a+='<div id="'+nsdLiveChat.id+'" class="nsd-chat-container" style="opacity: 0; display: none; position:fixed;">';a+='<iframe id="'+nsdLiveChat.iframeId+'" class="nsd-livechat-iframe" src="" allowtransparency="true"></iframe>';a+='<div class="close"></div>';a+="</div>";return a},liveChatLabel:function(){var a="";a+='<div id="'+nsdLiveChat.labelId+'" class="nsd-livechat-button';if(nsdLiveChat.liveChatInfo.hasOnlineUsers){a+=" online"}else{a+=" offline"}a+=" "+nsdLiveChat.mode().labelStyle;a+='" style="opacity: 0;">';a+='<div class="button-wrap">';a+='<div class="icon"></div>';if(nsdLiveChat.liveChatInfo.hasOnlineUsers){a+='<div class="consultant-unavailable top">Онлайн-консультант</div>';a+='<div class="leave-message bottom">ЗАДАТЬ ВОПРОС</div>'}else{a+='<div class="consultant-unavailable top">Онлайн-консультант недоступен</div>';a+='<div class="leave-message bottom">ОСТАВИТЬ СООБЩЕНИЕ</div>'}a+="</div>";a+="</div>";return a}};var modes={left:{labelStyle:"left",init:function(){nsdLiveChat.label().css("top","40%")},expand:function(){},collapse:function(){}},right:{labelStyle:"right",init:function(){nsdLiveChat.label().css("top","40%")},expand:function(){},collapse:function(){}},bottomRight:{labelStyle:"bottom",init:function(){nsdLiveChat.label().css("right","10%")},expand:function(){},collapse:function(){}},bottomLeft:{labelStyle:"bottom",init:function(){nsdLiveChat.label().css("left","10%")},expand:function(){},collapse:function(){}}};